(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6337],{18889:(e,s,t)=>{"use strict";t.d(s,{A:()=>o});var r=t(21555);let a=e=>{let s=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,s,t)=>t?t.toUpperCase():s.toLowerCase());return s.charAt(0).toUpperCase()+s.slice(1)},n=(...e)=>e.filter((e,s,t)=>!!e&&""!==e.trim()&&t.indexOf(e)===s).join(" ").trim();var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,r.forwardRef)(({color:e="currentColor",size:s=24,strokeWidth:t=2,absoluteStrokeWidth:a,className:l="",children:o,iconNode:c,...d},u)=>(0,r.createElement)("svg",{ref:u,...i,width:s,height:s,stroke:e,strokeWidth:a?24*Number(t)/Number(s):t,className:n("lucide",l),...!o&&!(e=>{for(let s in e)if(s.startsWith("aria-")||"role"===s||"title"===s)return!0})(d)&&{"aria-hidden":"true"},...d},[...c.map(([e,s])=>(0,r.createElement)(e,s)),...Array.isArray(o)?o:[o]])),o=(e,s)=>{let t=(0,r.forwardRef)(({className:t,...i},o)=>(0,r.createElement)(l,{ref:o,iconNode:s,className:n(`lucide-${a(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,t),...i}));return t.displayName=a(e),t}},19407:(e,s,t)=>{Promise.resolve().then(t.bind(t,98980))},30382:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(18889).A)("chef-hat",[["path",{d:"M17 21a1 1 0 0 0 1-1v-5.35c0-.457.316-.844.727-1.041a4 4 0 0 0-2.134-7.589 5 5 0 0 0-9.186 0 4 4 0 0 0-2.134 7.588c.411.198.727.585.727 1.041V20a1 1 0 0 0 1 1Z",key:"1qvrer"}],["path",{d:"M6 17h12",key:"1jwigz"}]])},33444:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(18889).A)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},45074:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(18889).A)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]])},48345:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(18889).A)("camera",[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]])},50497:(e,s,t)=>{"use strict";var r=t(60685);t.o(r,"usePathname")&&t.d(s,{usePathname:function(){return r.usePathname}}),t.o(r,"useRouter")&&t.d(s,{useRouter:function(){return r.useRouter}}),t.o(r,"useSearchParams")&&t.d(s,{useSearchParams:function(){return r.useSearchParams}})},67649:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(18889).A)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},69339:(e,s,t)=>{"use strict";t.d(s,{A:()=>n});var r=t(21555),a=t(15885);function n(){let[e,s]=(0,r.useState)(null),[t,n]=(0,r.useState)(!0),[i,l]=(0,r.useState)(!1),[o,c]=(0,r.useState)(null),d=(0,r.useCallback)(async()=>{try{let e=(0,a.getSupabase)(),{data:t,error:r}=await e.auth.refreshSession();if(r)return console.error("[useAuth] Refresh error:",r),!1;if(!t?.session)return console.error("[useAuth] No session returned after refresh"),!1;return c(t.session),s(t.session.user),console.log("[useAuth] Session refreshed successfully"),!0}catch(e){return console.error("[useAuth] Failed to refresh:",e),!1}},[]);return(0,r.useEffect)(()=>{a.api.getUser().then(({data:{user:e}})=>{s(e),n(!1),l(!0)}).catch(()=>{n(!1),l(!0)});let{data:{subscription:e}}=a.api.onAuthStateChange(async(e,t)=>{console.log("[useAuth] Auth state change:",e),"TOKEN_REFRESHED"===e&&console.log("[useAuth] Token refreshed successfully"),c(t),s(t?.user??null),n(!1),l(!0)});return()=>e.unsubscribe()},[]),{user:e,session:o,loading:t,isReady:i,authenticated:!!e,refreshSession:d,signOut:()=>a.api.signOut()}}},80215:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(18889).A)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]])},97114:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(18889).A)("history",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]])},98980:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>f});var r=t(55155),a=t(21555),n=t(69339),i=t(50497),l=t(15885),o=t(3948),c=t.n(o),d=t(45074),u=t(67649),h=t(33444),m=t(30382),g=t(48345),x=t(80215),p=t(97114);function f(){let{user:e,loading:s}=(0,n.A)(),t=(0,i.useRouter)(),[o,f]=(0,a.useState)({ingredientsCount:0,expiringCount:0,recentSessionsCount:0,totalRecipes:0}),[j,v]=(0,a.useState)([]),[N,A]=(0,a.useState)([]),[w,k]=(0,a.useState)(!0),[S,C]=(0,a.useState)(!1);(0,a.useEffect)(()=>{C(!0)},[]),(0,a.useEffect)(()=>{if(S){if(!s&&!e)return void t.push("/auth/login");e&&E()}},[S,e,s,t]);let E=async()=>{try{k(!0);let e=await l.api.getIngredients(),s=e.filter(e=>"expiring"===e.freshness||"wilted"===e.freshness);f(t=>({...t,ingredientsCount:e.length,expiringCount:s.length})),A(s.slice(0,5))}catch(e){console.error("Failed to load dashboard data:",e)}finally{k(!1)}};return!S||s||w?(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-600 mx-auto"}),(0,r.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading dashboard..."})]})}):(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 p-4 md:p-8",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Dashboard"}),(0,r.jsx)("p",{className:"text-gray-600 mt-2",children:"Welcome back! Here's what's happening in your kitchen."})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,r.jsx)(y,{icon:d.A,title:"Ingredients",value:o.ingredientsCount,color:"blue",href:"/ingredients"}),(0,r.jsx)(y,{icon:u.A,title:"Expiring Soon",value:o.expiringCount,color:"orange",href:"/ingredients?filter=expiring"}),(0,r.jsx)(y,{icon:h.A,title:"Cooking Sessions",value:o.recentSessionsCount,color:"purple",href:"/cooking"}),(0,r.jsx)(y,{icon:m.A,title:"My Recipes",value:o.totalRecipes,color:"green",href:"/recipes"})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Quick Actions"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsx)(b,{icon:g.A,label:"Scan Ingredients",href:"/scan",color:"emerald"}),(0,r.jsx)(b,{icon:m.A,label:"Start Cooking",href:"/cook",color:"orange"}),(0,r.jsx)(b,{icon:x.A,label:"Browse Recipes",href:"/recipes",color:"blue"})]})]}),N.length>0&&(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold",children:"Expiring Soon"}),(0,r.jsx)(c(),{href:"/ingredients?filter=expiring",className:"text-emerald-600 hover:text-emerald-700 text-sm font-medium",children:"View All â†’"})]}),(0,r.jsx)("div",{className:"space-y-3",children:N.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 bg-orange-50 border border-orange-200 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(u.A,{className:"w-5 h-5 text-orange-500"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium text-gray-900",children:e.name}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:null!==e.days_remaining_estimate&&void 0!==e.days_remaining_estimate?`${e.days_remaining_estimate} days left`:"Expires soon"})]})]}),(0,r.jsx)("span",{className:"px-3 py-1 text-xs font-medium rounded-full bg-orange-100 text-orange-800",children:e.freshness})]},e.id))})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Recent Activity"}),(0,r.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,r.jsx)(p.A,{className:"w-12 h-12 mx-auto mb-3 text-gray-400"}),(0,r.jsx)("p",{children:"No recent activity yet. Start by scanning ingredients or cooking a recipe!"})]})]})]})})}function y({icon:e,title:s,value:t,color:a,href:n}){let i=(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow cursor-pointer",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-600 text-sm font-medium",children:s}),(0,r.jsx)("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:t})]}),(0,r.jsx)("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${{blue:"bg-blue-100 text-blue-600",orange:"bg-orange-100 text-orange-600",purple:"bg-purple-100 text-purple-600",green:"bg-green-100 text-green-600"}[a]}`,children:(0,r.jsx)(e,{className:"w-6 h-6"})})]})});return n?(0,r.jsx)(c(),{href:n,children:i}):i}function b({icon:e,label:s,href:t,color:a}){return(0,r.jsxs)(c(),{href:t,className:`flex items-center justify-center gap-3 px-4 py-4 border-2 border-gray-200 rounded-lg transition-all ${{emerald:"hover:bg-emerald-50 hover:border-emerald-300",orange:"hover:bg-orange-50 hover:border-orange-300",blue:"hover:bg-blue-50 hover:border-blue-300"}[a]}`,children:[(0,r.jsx)(e,{className:"w-5 h-5 text-gray-700"}),(0,r.jsx)("span",{className:"font-medium text-gray-700",children:s})]})}}},e=>{e.O(0,[9731,9631,3948,5885,6939,1170,7358],()=>e(e.s=19407)),_N_E=e.O()}]);