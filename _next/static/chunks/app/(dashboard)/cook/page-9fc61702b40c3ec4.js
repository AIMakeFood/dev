(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7383],{49078:(e,t,a)=>{"use strict";a.d(t,{G:()=>i});var s=a(21555),r=a(94999),n=a(6895);function i(e={}){let{guidanceSettings:t,currentPersona:a}=(0,r.Wh)(),l=e.enabled??t.voice_enabled,o=e.voiceVolume??t.voice_volume,c=e.voiceSpeed??t.voice_speed,{speak:d,cancel:u,isSpeaking:h,isSupported:m,voices:x,setSelectedVoice:p}=function(e={}){let{defaultRate:t=1,defaultPitch:a=1,defaultVolume:r=1,preferredVoiceLang:n="en"}=e,[i,l]=(0,s.useState)([]),[o,c]=(0,s.useState)(null),[d,u]=(0,s.useState)(!1),[h,m]=(0,s.useState)(!1),[x,p]=(0,s.useState)(!1),g=(0,s.useRef)(null);(0,s.useEffect)(()=>{let e="speechSynthesis"in window;if(p(e),!e)return;let t=()=>{let e=window.speechSynthesis.getVoices();if(l(e),e.length>0&&!o){let t=e.find(e=>e.lang.startsWith(n)&&e.localService),a=e.find(e=>e.lang.startsWith(n));c(t||a||e[0])}};return t(),window.speechSynthesis.addEventListener("voiceschanged",t),()=>{window.speechSynthesis.removeEventListener("voiceschanged",t)}},[n,o]);let f=(0,s.useCallback)(e=>i.filter(t=>t.lang.startsWith(e)),[i]),b=(0,s.useCallback)((e,s={})=>{if(!x||!e)return;window.speechSynthesis.cancel();let n=new SpeechSynthesisUtterance(e);n.rate=s.rate??t,n.pitch=s.pitch??a,n.volume=s.volume??r,n.voice=s.voice??o,n.onstart=()=>{u(!0),m(!1)},n.onend=()=>{u(!1),m(!1)},n.onerror=e=>{console.error("Speech synthesis error:",e.error),u(!1),m(!1)},n.onpause=()=>{m(!0)},n.onresume=()=>{m(!1)},g.current=n,window.speechSynthesis.speak(n)},[x,t,a,r,o]),y=(0,s.useCallback)(()=>{x&&(window.speechSynthesis.cancel(),u(!1),m(!1))},[x]),v=(0,s.useCallback)(()=>{x&&d&&window.speechSynthesis.pause()},[x,d]),w=(0,s.useCallback)(()=>{x&&h&&window.speechSynthesis.resume()},[x,h]);return(0,s.useEffect)(()=>()=>{x&&window.speechSynthesis.cancel()},[x]),{speak:b,cancel:y,pause:v,resume:w,isSpeaking:d,isPaused:h,isSupported:x,voices:i,selectedVoice:o,setSelectedVoice:c,getVoicesByLang:f}}({defaultVolume:o,defaultRate:c}),[g,f]=(0,s.useState)([]),b=(0,s.useRef)(!1),y=(0,s.useRef)(new Map);(0,s.useEffect)(()=>{if(x.length>0&&a){let e=function(e,t){if(0===e.length)return null;let a=e.filter(e=>e.lang.startsWith("en"));switch(t){case"professional_chef":return a.find(e=>e.name.toLowerCase().includes("daniel"))||a.find(e=>e.name.toLowerCase().includes("james"))||a.find(e=>!e.name.toLowerCase().includes("female")&&e.localService)||a[0];case"friendly_mom":return a.find(e=>e.name.toLowerCase().includes("samantha"))||a.find(e=>e.name.toLowerCase().includes("karen"))||a.find(e=>e.name.toLowerCase().includes("female"))||a.find(e=>e.name.toLowerCase().includes("woman"))||a[0];case"gentle_grandma":return a.find(e=>e.name.toLowerCase().includes("fiona"))||a.find(e=>e.name.toLowerCase().includes("victoria"))||a.find(e=>e.name.toLowerCase().includes("female"))||a[0];case"surfer_dude":case"skater":return a.find(e=>e.name.toLowerCase().includes("alex"))||a.find(e=>e.name.toLowerCase().includes("tom"))||a.find(e=>"en-US"===e.lang&&e.localService)||a[0];case"gordon_style":return a.find(e=>"en-GB"===e.lang&&!e.name.toLowerCase().includes("female"))||a.find(e=>e.name.toLowerCase().includes("daniel"))||a[0];case"robot_chef":return a.find(e=>e.localService)||a[0];default:return a[0]||e[0]}}(x,a.id);e&&p(e)}},[x,a,p]),(0,s.useEffect)(()=>{if(!l||!m||h||0===g.length||b.current)return;b.current=!0;let e=[...g].sort((e,t)=>t.priority-e.priority)[0];f(t=>t.filter(t=>t!==e));let t=function(e){switch(e){case"professional_chef":default:return{rate:1,pitch:1};case"friendly_mom":return{rate:.95,pitch:1.1};case"gentle_grandma":return{rate:.85,pitch:1.05};case"surfer_dude":return{rate:.9,pitch:.95};case"skater":return{rate:1.15,pitch:1};case"gordon_style":return{rate:1.1,pitch:.9};case"robot_chef":return{rate:.95,pitch:.8}}}(a.id);d(e.text,{volume:o,rate:c*t.rate,pitch:t.pitch}),setTimeout(()=>{b.current=!1},500)},[l,m,h,g,a,d,o,c]);let v=(0,s.useCallback)((e,t=3e3)=>{if(!l||!m)return;let a=`${e.type}-${e.text.substring(0,50)}`,s=y.current.get(a),r=Date.now();s&&r-s<t||(y.current.set(a,r),f(t=>[...t.filter(t=>t.type!==e.type||t.text!==e.text),e]))},[l,m]),w=(0,s.useCallback)(e=>{if(!t.auto_speak.hazards)return;let s="critical"===e.severity||"safety"===e.severity?"urgent":"warning"===e.severity?"warning":"info";v({text:e.voice_message||(0,n.s_)(a.id,e.type,s),priority:"critical"===e.severity?10:"safety"===e.severity?8:5,type:"hazard"},"urgent"===s?2e3:5e3)},[a.id,t.auto_speak.hazards,v]),j=(0,s.useCallback)(e=>{t.auto_speak.tips&&v({text:e,priority:3,type:"tip"},1e4)},[t.auto_speak.tips,v]),N=(0,s.useCallback)(e=>{t.auto_speak.encouragement&&v({text:e,priority:2,type:"encouragement"},15e3)},[t.auto_speak.encouragement,v]),k=(0,s.useCallback)(e=>{t.auto_speak.progress&&v({text:e,priority:4,type:"progress"},5e3)},[t.auto_speak.progress,v]),S=(0,s.useCallback)(e=>{v({text:e,priority:5,type:"custom"},1e3)},[v]),C=(0,s.useCallback)(()=>{u(),f([]),b.current=!1},[u]),_=(0,s.useCallback)(()=>{f([])},[]);return{speakHazard:w,speakTip:j,speakEncouragement:N,speakProgress:k,speakCustom:S,cancel:C,isSpeaking:h,isSupported:m,currentPersona:a,queueLength:g.length,clearQueue:_}}},58915:(e,t,a)=>{"use strict";a.d(t,{k:()=>r});var s=a(55155);function r({size:e="md",text:t="AI is Thinking..."}){return(0,s.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,s.jsxs)("div",{className:`relative ${{sm:"w-8 h-8",md:"w-12 h-12",lg:"w-16 h-16"}[e]}`,children:[(0,s.jsx)("div",{className:"absolute inset-0 border-4 border-orange-200 rounded-full"}),(0,s.jsx)("div",{className:"absolute inset-0 border-4 border-orange-500 rounded-full border-t-transparent animate-spin"})]}),t&&(0,s.jsx)("p",{className:"text-xs font-bold uppercase tracking-widest text-orange-500 animate-pulse",children:t})]})}},83485:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>K});var s=a(55155),r=a(64119),n=a(59919),i=a(82833),l=a(95779),o=a(80312),c=a(53144),d=a(48345),u=a(7353),h=a(69979),m=a(5762),x=a(3738),p=a(62649),g=a(50497),f=a(21555),b=a(58915),y=a(73675),v=a(15749),w=a(95389),j=a(75686),N=a(67649),k=a(99802),S=a(39156),C=a(33444),_=a(44746),A=a(30382);let E={tip:{bg:"bg-teal-500",icon:w.A,label:"AI Tip"},info:{bg:"bg-blue-500",icon:j.A,label:"Info"},warning:{bg:"bg-yellow-500",icon:N.A,label:"Attention"},safety:{bg:"bg-red-500",border:"ring-4 ring-red-300",icon:N.A,label:"Safety Alert",pulse:!0},critical:{bg:"bg-red-600",border:"ring-4 ring-red-400 ring-opacity-75",icon:k.A,label:"DANGER",pulse:!0},success:{bg:"bg-green-500",icon:S.A,label:"Great Job"},timing:{bg:"bg-orange-500",icon:C.A,label:"Timing"}};function $({guidance:e,type:t="tip",onDismiss:a,persistent:r=!1,onPlaySound:n}){let i=(0,f.useRef)(!1);if((0,f.useEffect)(()=>{if(e&&!i.current&&n){let e="critical"===t?"safety":"info"===t||"timing"===t?"tip":t;("tip"===e||"warning"===e||"safety"===e||"success"===e)&&n(e),i.current=!0}e||(i.current=!1)},[e,t,n]),!e)return null;let l=E[t],o=l.icon;return(0,s.jsx)(y.N,{children:(0,s.jsxs)(v.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:`absolute bottom-20 left-4 right-4 ${l.bg} ${l.border||""} text-white p-4 rounded-2xl shadow-2xl z-20`,children:[l.pulse&&(0,s.jsx)(v.P.div,{className:`absolute inset-0 ${l.bg} rounded-2xl`,animate:{scale:[1,1.02,1],opacity:[1,.8,1]},transition:{duration:.5,repeat:1/0}}),(0,s.jsxs)("div",{className:"relative flex items-start gap-3",role:"safety"===t||"critical"===t?"alert":"status","aria-live":"safety"===t||"critical"===t?"assertive":"polite","aria-atomic":"true",children:[(0,s.jsx)(v.P.div,{animate:l.pulse?{scale:[1,1.2,1]}:{},transition:{duration:.5,repeat:1/0},"aria-hidden":"true",children:(0,s.jsx)(o,{className:"w-6 h-6 flex-shrink-0 mt-0.5"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"text-xs font-bold uppercase tracking-wider opacity-80",children:l.label}),(0,s.jsx)("p",{className:"font-medium mt-1",children:e})]}),a&&!r&&(0,s.jsx)("button",{onClick:a,className:"p-1 hover:bg-white/20 rounded-full transition-colors",children:(0,s.jsx)(_.A,{className:"w-4 h-4"})})]})]})})}function z({safetyEvent:e,onAcknowledge:t,onPlaySound:a}){let r=(0,f.useRef)(null);if((0,f.useEffect)(()=>{e&&r.current!==e.id&&a&&(a("critical"===e.severity||"safety"===e.severity?"safety":"warning"),r.current=e.id)},[e,a]),!e)return null;let n="critical"===e.severity||"safety"===e.severity;return(0,s.jsx)(y.N,{children:(0,s.jsxs)(v.P.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:`absolute inset-x-4 top-1/4 z-30 ${n?"bg-red-600":"bg-yellow-500"}
          text-white p-6 rounded-2xl shadow-2xl ${n?"ring-4 ring-red-300":""}`,children:[n&&(0,s.jsx)(v.P.div,{className:"absolute inset-0 bg-red-600 rounded-2xl",animate:{boxShadow:["0 0 0 0 rgba(239, 68, 68, 0.7)","0 0 0 20px rgba(239, 68, 68, 0)","0 0 0 0 rgba(239, 68, 68, 0)"]},transition:{duration:1,repeat:1/0}}),(0,s.jsxs)("div",{className:"relative flex flex-col items-center text-center gap-4",role:"alert","aria-live":"assertive","aria-atomic":"true",children:[(0,s.jsx)(v.P.div,{animate:{scale:[1,1.2,1],rotate:[0,-10,10,0]},transition:{duration:.5,repeat:1/0},"aria-hidden":"true",children:n?(0,s.jsx)(k.A,{className:"w-12 h-12"}):(0,s.jsx)(N.A,{className:"w-12 h-12"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-bold uppercase tracking-wider opacity-80",children:n?"⚠️ DANGER ⚠️":"Warning"}),(0,s.jsx)("p",{className:"text-lg font-bold mt-2",children:e.message})]}),t&&(0,s.jsx)("button",{onClick:t,className:`px-6 py-2 rounded-full font-bold transition-colors ${n?"bg-white text-red-600 hover:bg-red-100":"bg-white text-yellow-600 hover:bg-yellow-100"}`,children:"I Understand"})]})]})})}function I({technique:e,onDismiss:t}){return e?(0,s.jsx)(y.N,{children:(0,s.jsx)(v.P.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"absolute top-4 right-4 bg-white/95 backdrop-blur rounded-xl shadow-lg p-4 max-w-xs z-20",children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)(A.A,{className:"w-5 h-5 text-slate-600 mt-0.5"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("p",{className:"text-sm font-bold text-slate-800",children:e.technique}),(0,s.jsx)("span",{className:`px-2 py-0.5 rounded text-xs font-bold text-white ${{poor:"bg-red-500",fair:"bg-yellow-500",good:"bg-green-500",excellent:"bg-teal-500"}[e.quality]}`,children:e.quality})]}),(0,s.jsx)("p",{className:"text-sm text-slate-600 mt-1",children:e.feedback}),e.improvement_tip&&(0,s.jsxs)("p",{className:"text-xs text-teal-600 mt-2 italic",children:["\uD83D\uDCA1 ",e.improvement_tip]})]}),t&&(0,s.jsx)("button",{onClick:t,className:"p-1 hover:bg-slate-100 rounded-full",children:(0,s.jsx)(_.A,{className:"w-4 h-4 text-slate-400"})})]})})}):null}function R({message:e,onDismiss:t,onPlaySound:a}){let r=(0,f.useRef)(!1);return((0,f.useEffect)(()=>{e&&!r.current&&a&&(a("timer"),r.current=!0),e||(r.current=!1)},[e,a]),e)?(0,s.jsx)(y.N,{children:(0,s.jsx)(v.P.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"absolute top-4 left-4 right-4 bg-orange-500 text-white px-4 py-3 rounded-xl shadow-lg z-20",children:(0,s.jsxs)(v.P.div,{className:"flex items-center gap-3",animate:{x:[0,5,-5,0]},transition:{duration:.3,repeat:3},children:[(0,s.jsx)(C.A,{className:"w-5 h-5"}),(0,s.jsx)("p",{className:"font-bold flex-1",children:e}),t&&(0,s.jsx)("button",{onClick:t,className:"p-1 hover:bg-white/20 rounded-full",children:(0,s.jsx)(_.A,{className:"w-4 h-4"})})]})})}):null}function P({count:e,hasCritical:t,onClick:a}){return 0===e?null:(0,s.jsxs)(v.P.button,{initial:{scale:0},animate:{scale:1},onClick:a,className:`fixed top-4 right-4 ${t?"bg-red-500":"bg-yellow-500"}
        text-white px-3 py-1.5 rounded-full font-bold text-sm shadow-lg z-50 flex items-center gap-2`,children:[(0,s.jsx)(N.A,{className:"w-4 h-4"}),e," Alert",e>1?"s":""]})}var q=a(45723),D=a(33971),L=a(57809);function T({ingredients:e,onUpdate:t,onClose:a}){let[r,n]=(0,f.useState)(e),[i,l]=(0,f.useState)({name:"",quantity:"",unit:""});return(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,s.jsxs)(L.Zp,{className:"max-w-2xl w-full max-h-[80vh] overflow-auto p-6 bg-white dark:bg-slate-900",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"Modify Ingredients"}),(0,s.jsx)(D.$,{variant:"ghost",size:"icon",onClick:a,children:(0,s.jsx)(_.A,{className:"w-5 h-5"})})]}),(0,s.jsx)("div",{className:"space-y-4 mb-6",children:r.map(e=>(0,s.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-slate-50 dark:bg-slate-800 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("span",{className:"font-medium text-slate-900 dark:text-white",children:e.name}),(0,s.jsxs)("span",{className:"text-sm text-slate-500 dark:text-slate-400 ml-2",children:[e.quantity," ",e.unit]})]}),(0,s.jsx)(D.$,{variant:"ghost",size:"icon",onClick:()=>{var t;return t=e.id,void n(r.filter(e=>e.id!==t))},className:"text-red-500 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-950",children:(0,s.jsx)(q.A,{className:"w-4 h-4"})})]},e.id))}),(0,s.jsxs)("div",{className:"space-y-3 mb-6 p-4 bg-slate-50 dark:bg-slate-800 rounded-lg",children:[(0,s.jsx)("h3",{className:"font-semibold text-slate-900 dark:text-white",children:"Add Ingredient"}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,s.jsx)("input",{type:"text",placeholder:"Name",value:i.name,onChange:e=>l({...i,name:e.target.value}),className:"px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-900 text-slate-900 dark:text-white"}),(0,s.jsx)("input",{type:"number",placeholder:"Quantity",value:i.quantity,onChange:e=>l({...i,quantity:e.target.value}),className:"px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-900 text-slate-900 dark:text-white"}),(0,s.jsx)("input",{type:"text",placeholder:"Unit",value:i.unit,onChange:e=>l({...i,unit:e.target.value}),className:"px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-900 text-slate-900 dark:text-white"})]}),(0,s.jsxs)(D.$,{onClick:()=>{i.name&&i.quantity&&(n([...r,{id:crypto.randomUUID(),name:i.name,quantity:parseFloat(i.quantity),unit:i.unit||"pcs",category:"other",confidence:1,scanned_at:new Date().toISOString()}]),l({name:"",quantity:"",unit:""}))},variant:"outline",className:"w-full",children:[(0,s.jsx)(x.A,{className:"w-4 h-4 mr-2"}),"Add"]})]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)(D.$,{onClick:a,variant:"outline",className:"flex-1",children:"Cancel"}),(0,s.jsx)(D.$,{onClick:()=>t(r),className:"flex-1 bg-gradient-to-r from-brand-orange to-brand-teal",children:"Update & Regenerate Steps"})]})]})})}function M({step:e,isActive:t}){return(0,s.jsx)("div",{className:`p-6 rounded-3xl transition-all duration-500 border-2 ${t?"bg-white border-orange-500 shadow-xl scale-105":"bg-slate-50 border-transparent opacity-50"}`,children:(0,s.jsxs)("div",{className:"flex items-start gap-4",children:[(0,s.jsx)("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-bold ${t?"bg-orange-500 text-white":"bg-slate-200 text-slate-500"}`,children:e.step_number}),(0,s.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,s.jsx)("p",{className:"text-lg font-medium text-slate-900",children:e.instruction}),e.tips&&(0,s.jsxs)("div",{className:"flex items-start gap-2 text-sm text-teal-600 bg-teal-50 p-2 rounded-lg",children:[(0,s.jsx)(j.A,{className:"w-4 h-4 mt-0.5"}),(0,s.jsx)("span",{children:e.tips})]}),e.duration_minutes&&(0,s.jsxs)("p",{className:"text-xs text-slate-400",children:["Estimated time: ",e.duration_minutes," minutes"]})]}),t&&(0,s.jsx)(S.A,{className:"text-orange-500 w-6 h-6 animate-pulse"})]})})}var F=a(32447);function U({duration:e,onComplete:t}){let a,[r,n]=(0,f.useState)(60*e),[i,l]=(0,f.useState)(!1);return(0,f.useEffect)(()=>{let e;return i&&r>0?e=setInterval(()=>n(e=>e-1),1e3):0===r&&(l(!1),t?.()),()=>clearInterval(e)},[i,r,t]),(0,s.jsxs)("div",{className:"bg-slate-100 dark:bg-slate-900 text-slate-900 dark:text-white p-4 rounded-2xl flex items-center gap-4 shadow-xl border border-slate-200 dark:border-white/10",children:[(0,s.jsx)("div",{className:"p-2 bg-orange-500 rounded-lg",children:(0,s.jsx)(C.A,{className:"w-5 h-5 text-white"})}),(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)("div",{className:"text-2xl font-mono font-black",children:(a=Math.floor(r/60),`${a}:${(r%60).toString().padStart(2,"0")}`)})}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(D.$,{size:"icon",variant:"ghost",onClick:()=>l(!i),className:"hover:bg-slate-200 dark:hover:bg-white/10",children:i?(0,s.jsx)(c.A,{className:"w-4 h-4"}):(0,s.jsx)(o.A,{className:"w-4 h-4"})}),(0,s.jsx)(D.$,{size:"icon",variant:"ghost",onClick:()=>{n(60*e),l(!1)},className:"hover:bg-slate-200 dark:hover:bg-white/10",children:(0,s.jsx)(F.A,{className:"w-4 h-4"})})]})]})}let W={safe:{border:"#22c55e",bg:"rgba(34, 197, 94, 0.15)",text:"#22c55e"},caution:{border:"#eab308",bg:"rgba(234, 179, 8, 0.15)",text:"#eab308"},hazard:{border:"#ef4444",bg:"rgba(239, 68, 68, 0.2)",text:"#ef4444"},ingredient:{border:"#2EC4B6",bg:"rgba(46, 196, 182, 0.15)",text:"#2EC4B6"},equipment:{border:"#8b5cf6",bg:"rgba(139, 92, 246, 0.15)",text:"#8b5cf6"}};function O({markers:e,containerWidth:t,containerHeight:a,showLabels:r=!0,showConfidence:n=!1}){return(0,s.jsx)("div",{className:"absolute inset-0 pointer-events-none overflow-hidden",style:{width:t,height:a},children:(0,s.jsx)(y.N,{children:e.map(e=>{let i=W[e.type],l=e.x/100*t,o=e.y/100*a,c=e.width?e.width/100*t:80,d=e.height?e.height/100*a:60;return(0,s.jsxs)(v.P.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.3},className:"absolute",style:{left:l-c/2,top:o-d/2,width:c,height:d},children:[(0,s.jsx)("div",{className:"absolute inset-0 rounded-lg",style:{border:`2px solid ${i.border}`,backgroundColor:i.bg,boxShadow:"hazard"===e.type?`0 0 20px ${i.border}, inset 0 0 10px ${i.bg}`:`0 0 10px ${i.bg}`}}),"hazard"===e.type&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"absolute -top-1 -left-1 w-3 h-3",style:{borderTop:`3px solid ${i.border}`,borderLeft:`3px solid ${i.border}`}}),(0,s.jsx)("div",{className:"absolute -top-1 -right-1 w-3 h-3",style:{borderTop:`3px solid ${i.border}`,borderRight:`3px solid ${i.border}`}}),(0,s.jsx)("div",{className:"absolute -bottom-1 -left-1 w-3 h-3",style:{borderBottom:`3px solid ${i.border}`,borderLeft:`3px solid ${i.border}`}}),(0,s.jsx)("div",{className:"absolute -bottom-1 -right-1 w-3 h-3",style:{borderBottom:`3px solid ${i.border}`,borderRight:`3px solid ${i.border}`}})]}),"hazard"===e.type&&(0,s.jsx)(v.P.div,{className:"absolute inset-0 rounded-lg",style:{border:`2px solid ${i.border}`},animate:{scale:[1,1.1,1],opacity:[.8,.2,.8]},transition:{duration:1,repeat:1/0,ease:"easeInOut"}}),r&&(0,s.jsxs)(v.P.div,{initial:{y:-10,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1},className:"absolute -top-7 left-0 px-2 py-0.5 rounded text-xs font-bold whitespace-nowrap",style:{backgroundColor:i.border,color:"#fff",boxShadow:"0 2px 4px rgba(0,0,0,0.3)"},children:[e.label,n&&(0,s.jsxs)("span",{className:"ml-1 opacity-80",children:[Math.round(100*e.confidence),"%"]})]}),(0,s.jsx)("div",{className:"absolute left-1/2 top-1/2 w-2 h-2 rounded-full -translate-x-1/2 -translate-y-1/2",style:{backgroundColor:i.border}})]},e.id)})})})}var H=a(80501),V=a(93842);let B={critical:4,safety:3,warning:2,info:1};var G=a(94999),Z=a(49078),J=a(15885);function Y(){let e=(0,g.useSearchParams)().get("id"),t=(0,g.useRouter)(),[a,p]=(0,f.useState)(null),[y,v]=(0,f.useState)(null),[w,j]=(0,f.useState)(!0),[N,k]=(0,f.useState)(null),[S,C]=(0,f.useState)(null),[_,A]=(0,f.useState)(null),[E,q]=(0,f.useState)([]),[F,W]=(0,f.useState)(!1),[Y,K]=(0,f.useState)(!0),[X,ee]=(0,f.useState)(!0),[et,ea]=(0,f.useState)([]),[es,er]=(0,f.useState)(!1),{step:en,nextStep:ei,prevStep:el,paused:eo,togglePause:ec,clearSession:ed}=function(e){let t=`aimakefood_session_${e}`,[a,s]=(0,f.useState)(()=>{let e=localStorage.getItem(t);return e?JSON.parse(e):{step:1,startTime:Date.now(),paused:!1}});return(0,f.useEffect)(()=>{localStorage.setItem(t,JSON.stringify(a))},[a,t]),{...a,nextStep:()=>s(e=>({...e,step:e.step+1})),prevStep:()=>s(e=>({...e,step:Math.max(1,e.step-1)})),goToStep:e=>s(t=>({...t,step:e})),togglePause:()=>s(e=>({...e,paused:!e.paused})),clearSession:()=>localStorage.removeItem(t),elapsedMinutes:Math.floor((Date.now()-a.startTime)/6e4)}}(e||""),{videoRef:eu,canvasRef:eh,isActive:em,startCamera:ex,captureFrame:ep}=(0,V.V)(),{speak:eg,isMuted:ef,toggleMute:eb}=function(){let[e,t]=(0,f.useState)(!1),[a,s]=(0,f.useState)(!1);return{speak:(0,f.useCallback)(t=>{if(e||!("speechSynthesis"in window))return;window.speechSynthesis.cancel();let a=new SpeechSynthesisUtterance(t);a.rate=.9,a.pitch=1;let r=window.speechSynthesis.getVoices().find(e=>e.name.includes("Google")||e.name.includes("Premium")||e.lang.startsWith("en"));r&&(a.voice=r),a.onstart=()=>s(!0),a.onend=()=>s(!1),a.onerror=()=>s(!1),window.speechSynthesis.speak(a)},[e]),stop:(0,f.useCallback)(()=>{"speechSynthesis"in window&&(window.speechSynthesis.cancel(),s(!1))},[]),isMuted:e,isSpeaking:a,toggleMute:()=>t(!e)}}(),{playAlert:ey,initAudioContext:ev}=(0,H.H)({enabled:Y}),{currentAlert:ew,alertHistory:ej,unacknowledgedCount:eN,hasCriticalAlerts:ek,addAlerts:eS,acknowledgeCurrentAlert:eC,getSafetySummary:e_}=function(e={}){let{autoAcknowledgeDelay:t=5e3,maxQueueSize:a=10,onAlertAdded:s}=e,[r,n]=(0,f.useState)([]),[i,l]=(0,f.useState)([]),o=(0,f.useRef)(new Map),c=r.find(e=>!e.acknowledged)||null,d=(0,f.useCallback)(e=>{n(t=>t.map(t=>t.id===e?{...t,acknowledged:!0}:t));let t=o.current.get(e);t&&(clearTimeout(t),o.current.delete(e))},[]),u=(0,f.useCallback)(e=>{let r={id:"id"in e?e.id:`alert-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,timestamp:"timestamp"in e?e.timestamp:new Date().toISOString(),acknowledged:"acknowledged"in e&&e.acknowledged,severity:e.severity,hazard_type:e.hazard_type,message:e.message};if(n(e=>e.some(e=>e.message===r.message&&Date.now()-new Date(e.timestamp).getTime()<5e3)?e:[...e,r].sort((e,t)=>B[t.severity]-B[e.severity]).slice(0,a)),l(e=>[r,...e].slice(0,50)),"info"===r.severity||"warning"===r.severity){let e=setTimeout(()=>{d(r.id)},t);o.current.set(r.id,e)}s?.(r)},[t,a,s,d]),h=(0,f.useCallback)(e=>{e.forEach(e=>u(e))},[u]),m=(0,f.useCallback)(()=>{c&&d(c.id)},[c,d]),x=(0,f.useCallback)(()=>{n(e=>e.map(e=>({...e,acknowledged:!0}))),o.current.forEach(e=>clearTimeout(e)),o.current.clear()},[]),p=(0,f.useCallback)(()=>{n(e=>e.filter(e=>!e.acknowledged))},[]),g=(0,f.useCallback)(e=>r.filter(t=>t.severity===e),[r]),b=r.filter(e=>!e.acknowledged).length,y=r.some(e=>!e.acknowledged&&("critical"===e.severity||"safety"===e.severity)),v=(0,f.useCallback)(()=>{let e={total:i.length,bySeverity:{critical:i.filter(e=>"critical"===e.severity).length,safety:i.filter(e=>"safety"===e.severity).length,warning:i.filter(e=>"warning"===e.severity).length,info:i.filter(e=>"info"===e.severity).length},byType:{},timeline:i.map(e=>({time:e.timestamp,severity:e.severity,message:e.message}))};return i.forEach(t=>{e.byType[t.hazard_type]=(e.byType[t.hazard_type]||0)+1}),e},[i]);return(0,f.useEffect)(()=>()=>{o.current.forEach(e=>clearTimeout(e))},[]),{currentAlert:c,alertQueue:r,alertHistory:i,unacknowledgedCount:b,hasCriticalAlerts:y,addAlert:u,addAlerts:h,acknowledgeAlert:d,acknowledgeCurrentAlert:m,acknowledgeAllAlerts:x,clearAcknowledgedAlerts:p,getAlertsBySeverity:g,getSafetySummary:v}}(),{scannerEnabled:eA,setCookingActive:eE}=(0,G._t)(),{startScanning:e$,stopScanning:ez,isScanning:eI,activeHazards:eR,userPresent:eP,awayDuration:eq}=function(e={}){let{videoRef:t,captureInterval:a=2e3,onHazardsDetected:s,onUserPresenceChange:r}=e,{scannerEnabled:n,safetySettings:i,isScanning:l,setScanning:o,updateAnalysis:c,lastAnalysis:d,activeHazards:u,userPresent:h,setUserPresent:m,lastUserSeen:x,cookingActive:p}=(0,G._t)(),{speakHazard:g}=(0,Z.G)(),[b,y]=(0,f.useState)(null),[v,w]=(0,f.useState)(0),j=(0,f.useRef)(null),N=(0,f.useRef)(null),k=(0,f.useRef)(null),S=(0,f.useRef)(new Map);(0,f.useEffect)(()=>{"u">typeof document&&(k.current=document.createElement("canvas"))},[]),(0,f.useEffect)(()=>n&&i.automation.away_detection.enabled?(N.current=setInterval(()=>{!h&&x?w(Math.floor((Date.now()-x.getTime())/1e3)):w(0)},1e3),()=>{N.current&&clearInterval(N.current)}):void w(0),[n,i.automation.away_detection.enabled,h,x]);let C=(0,f.useCallback)(()=>{if(!t?.current||!k.current)return null;let e=t.current,a=k.current;if(e.readyState<2)return null;let s=Math.min(640/e.videoWidth,480/e.videoHeight,1);a.width=Math.round(e.videoWidth*s),a.height=Math.round(e.videoHeight*s);let r=a.getContext("2d");return r?(r.drawImage(e,0,0,a.width,a.height),a.toDataURL("image/jpeg",.4)):null},[t]),_=(0,f.useCallback)(async e=>{try{let t=await J.api.analyzeSafetyFrame(e,i,p,"video");return{hazards:t.hazards.map(e=>({type:e.type,severity:e.severity,message:e.message,voice_message:e.voice_message,location:e.location,confidence:e.confidence??.8})),technique_guidance:t.technique_guidance?{current_action:t.technique_guidance.current_action,quality:t.technique_guidance.quality,suggestion:t.technique_guidance.suggestion}:void 0,user_present:t.user_present,overall_safety:t.overall_safety}}catch(e){return console.error("Frame analysis error:",e),y(e instanceof Error?e.message:"Analysis failed"),null}},[i,p]),A=(0,f.useCallback)(e=>{if(c(e),e.user_present!==h&&(m(e.user_present),r?.(e.user_present)),e.hazards.length>0){s?.(e.hazards);let t=Date.now();for(let a of e.hazards){let e=S.current.get(a.type),s="critical"===a.severity?5e3:1e4;(!e||t-e>s)&&(g(a),S.current.set(a.type,t))}}},[c,h,m,r,s,g]),E=(0,f.useCallback)(async()=>{let e=C();if(!e)return y("Failed to capture frame"),null;y(null);let t=await _(e);return t&&A(t),t},[C,_,A]),$=(0,f.useCallback)(()=>{n&&!l&&(o(!0),y(null),E(),j.current=setInterval(()=>{E()},a))},[n,l,o,E,a]),z=(0,f.useCallback)(()=>{j.current&&(clearInterval(j.current),j.current=null),o(!1),y(null)},[o]),I=(0,f.useCallback)(()=>{m(!0),w(0)},[m]);return(0,f.useEffect)(()=>()=>{j.current&&clearInterval(j.current),N.current&&clearInterval(N.current)},[]),(0,f.useEffect)(()=>{!n&&l&&z()},[n,l,z]),{isScanning:l,lastAnalysis:d,activeHazards:u,userPresent:h,awayDuration:v,error:b,startScanning:$,stopScanning:z,captureAndAnalyze:E,resetAwayTimer:I}}({videoRef:eu,onHazardsDetected:e=>{eS(e.map(e=>({id:`hazard-${Date.now()}-${Math.random()}`,severity:e.severity,hazard_type:e.type,message:e.message,timestamp:new Date().toISOString(),acknowledged:!1})))}}),eD=(0,f.useRef)(null),eL=(0,f.useRef)(null),[eT,eM]=(0,f.useState)({width:0,height:0});(0,f.useEffect)(()=>{let e=()=>{eL.current&&eM({width:eL.current.offsetWidth,height:eL.current.offsetHeight})};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,f.useEffect)(()=>(a&&eE(!0),()=>{eE(!1)}),[a,eE]),(0,f.useEffect)(()=>{eA&&!em&&a&&ex()},[eA,em,a,ex]),(0,f.useEffect)(()=>{em&&eA&&!eo?e$():ez()},[em,eA,eo,e$,ez]),(0,f.useEffect)(()=>{!async function(){if(!e)return j(!1);try{let t=await J.api.getCookingSession(e);if(t){if(p(t),t.recipe_snapshot)v(t.recipe_snapshot),t.recipe_snapshot.ingredients&&ea(t.recipe_snapshot.ingredients);else if(t.recipe_id){let e=await J.api.getRecipeById(t.recipe_id);v(e),e?.ingredients&&ea(e.ingredients)}}}catch(e){console.error("Failed to load session:",e)}finally{j(!1)}}()},[e]);let eF=(0,f.useCallback)(async()=>{if(!em||F||eo||!y)return;let e=ep();if(e){W(!0);try{let t=y.steps.find(e=>e.step_number===en),a=(await J.api.analyzeFrame(e,"cooking",{step:en,recipe_title:y.title,current_instruction:t?.instruction})).analysis;k(a),a.technique&&C(a.technique),a.timing_alert&&(A(a.timing_alert),ey("timer")),a.markers&&a.markers.length>0?q(a.markers):q([]),a.safety_events&&a.safety_events.length>0&&eS(a.safety_events),a.safety_alert?(eg(a.safety_alert),ey("safety")):a.timing_alert?eg(a.timing_alert):a.guidance&&a.confidence>.7&&(eg(a.guidance),ey("tip"))}catch(e){console.error("Frame analysis failed:",e)}finally{W(!1)}}},[em,F,eo,y,en,ep,eg,ey,eS]);(0,f.useEffect)(()=>(em&&!eo?eD.current=setInterval(eF,5e3):eD.current&&clearInterval(eD.current),()=>{eD.current&&clearInterval(eD.current)}),[em,eo,eF]);let eU=(0,f.useCallback)(()=>{ei(),ey("step"),C(null),A(null)},[ei,ey]),eW=async()=>{if(a&&e)try{e_(),await J.api.updateSession(a.id,{status:"completed",current_step:en,ai_interventions:[...a.ai_interventions,...ej.map(e=>({timestamp:e.timestamp,type:"info"===e.severity?"tip":"warning"===e.severity?"warning":"safety",guidance:e.message,confidence:1}))]}),ey("success"),ed(),t.push(`/cook/done?id=${e}`)}catch(e){console.error("Failed to complete session:",e)}},eO=async e=>{if(a){ea(e),er(!1);try{let t=await J.api.regenerateRecipeSteps(a.id,e);v(t),ey("tip")}catch(e){console.error("Failed to update recipe:",e)}}},eH=(0,f.useCallback)(()=>{ev(),ex()},[ev,ex]);if(w)return(0,s.jsx)("div",{className:"flex items-center justify-center min-h-[60vh]",children:(0,s.jsx)(b.k,{size:"lg",text:"Loading cooking session..."})});if(!e)return(0,s.jsx)(Q,{});if(!a||!y)return(0,s.jsxs)("div",{className:"text-center py-20",children:[(0,s.jsx)("h2",{className:"text-xl font-bold",children:"Session not found"}),(0,s.jsx)(D.$,{variant:"ghost",onClick:()=>t.push("/recipes"),className:"mt-4",children:"Back to Recipes"})]});let eV=y.steps.find(e=>e.step_number===en),eB=en===y.steps.length;return(0,s.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,s.jsx)(P,{count:eN,hasCritical:ek}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-black",children:y.title}),(0,s.jsxs)("p",{className:"text-slate-500",children:["Step ",en," of ",y.steps.length]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(D.$,{variant:"ghost",size:"icon",onClick:()=>K(!Y),"aria-label":Y?"Disable sound alerts":"Enable sound alerts",title:Y?"Disable sound alerts":"Enable sound alerts",children:Y?(0,s.jsx)(r.A,{className:"w-5 h-5"}):(0,s.jsx)(n.A,{className:"w-5 h-5"})}),(0,s.jsx)(D.$,{variant:"ghost",size:"icon",onClick:eb,"aria-label":ef?"Unmute voice guidance":"Mute voice guidance",children:ef?(0,s.jsx)(i.A,{className:"w-5 h-5"}):(0,s.jsx)(l.A,{className:"w-5 h-5"})}),(0,s.jsx)(D.$,{variant:"ghost",size:"icon",onClick:ec,"aria-label":eo?"Resume cooking session":"Pause cooking session",children:eo?(0,s.jsx)(o.A,{className:"w-5 h-5"}):(0,s.jsx)(c.A,{className:"w-5 h-5"})})]})]}),(0,s.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{ref:eL,className:"relative bg-slate-900 rounded-3xl overflow-hidden aspect-[4/3]",children:[(0,s.jsx)("video",{ref:eu,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover"}),(0,s.jsx)("canvas",{ref:eh,className:"hidden"}),em&&X&&E.length>0&&(0,s.jsx)(O,{markers:E,containerWidth:eT.width,containerHeight:eT.height,showLabels:!0,showConfidence:!1}),!em&&(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-slate-900",children:(0,s.jsxs)(D.$,{onClick:eH,size:"lg",children:[(0,s.jsx)(d.A,{className:"w-5 h-5 mr-2"}),"Enable AI Vision"]})}),F&&(0,s.jsx)("div",{className:"absolute top-4 left-4 px-3 py-1.5 bg-orange-500 text-white text-xs font-bold rounded-full animate-pulse",children:"AI Analyzing..."}),eI&&(0,s.jsxs)("div",{className:"absolute top-4 right-4 px-3 py-1.5 bg-green-500 text-white text-xs font-bold rounded-full flex items-center gap-1",children:[(0,s.jsx)("span",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),"Safety Active"]}),!eP&&eq>30&&em&&(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-amber-900/80 z-20",children:(0,s.jsxs)("div",{className:"text-center text-white p-6",children:[(0,s.jsx)("div",{className:"text-4xl mb-4",children:"\uD83D\uDC40"}),(0,s.jsx)("h3",{className:"text-xl font-bold mb-2",children:"Are you still there?"}),(0,s.jsxs)("p",{className:"text-amber-200",children:["You've been away for ",Math.floor(eq/60),":",(eq%60).toString().padStart(2,"0")]}),(0,s.jsx)("p",{className:"text-sm text-amber-300 mt-2",children:"Your cooking may need attention"})]})}),(0,s.jsx)(R,{message:_,onDismiss:()=>A(null),onPlaySound:ey}),(0,s.jsx)(z,{safetyEvent:ew,onAcknowledge:eC,onPlaySound:ey}),(0,s.jsx)(I,{technique:S,onDismiss:()=>C(null)}),!ew&&(0,s.jsx)($,{guidance:N?.guidance||null,type:N?.safety_alert?"safety":"tip",onDismiss:()=>k(null),onPlaySound:ey})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[eV&&(0,s.jsx)(M,{step:eV,isActive:!0}),eV?.duration_minutes&&(0,s.jsx)(U,{duration:eV.duration_minutes,onComplete:()=>ey("timer")}),N?.next_action&&(0,s.jsx)(L.Zp,{className:"p-3 bg-teal-50 border-teal-200",children:(0,s.jsxs)("p",{className:"text-sm text-teal-700",children:[(0,s.jsx)("span",{className:"font-bold",children:"Next:"})," ",N.next_action]})}),(0,s.jsx)(L.Zp,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(D.$,{variant:"outline",onClick:el,disabled:1===en,className:"flex-1",children:[(0,s.jsx)(u.A,{className:"w-4 h-4 mr-1"}),"Previous"]}),eB?(0,s.jsxs)(D.$,{onClick:eW,className:"flex-1",children:[(0,s.jsx)(h.A,{className:"w-4 h-4 mr-1"}),"Complete"]}):(0,s.jsxs)(D.$,{onClick:eU,className:"flex-1",children:["Next",(0,s.jsx)(m.A,{className:"w-4 h-4 ml-1"})]})]})}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between text-xs text-slate-400",children:[(0,s.jsx)("span",{children:"Progress"}),(0,s.jsxs)("span",{children:[Math.round(en/y.steps.length*100),"%"]})]}),(0,s.jsx)("div",{className:"h-2 bg-slate-100 rounded-full overflow-hidden",children:(0,s.jsx)("div",{className:"h-full bg-gradient-to-r from-orange-500 to-teal-500 transition-all duration-300",style:{width:`${en/y.steps.length*100}%`}})})]}),em&&(0,s.jsxs)("button",{onClick:()=>ee(!X),className:"text-xs text-slate-400 hover:text-slate-600",children:[X?"Hide":"Show"," AI detection markers"]})]})]}),(0,s.jsxs)(D.$,{onClick:()=>er(!0),className:"fixed bottom-24 right-6 z-50 shadow-lg",size:"lg",children:[(0,s.jsx)(x.A,{className:"w-4 h-4 mr-2"}),"Modify Ingredients"]}),es&&(0,s.jsx)(T,{ingredients:et,onUpdate:eO,onClose:()=>er(!1)})]})}function Q(){let e=(0,g.useRouter)(),[t,a]=(0,f.useState)(!0),[r,n]=(0,f.useState)([]),[i,l]=(0,f.useState)(new Set),[o,c]=(0,f.useState)(!1);(0,f.useEffect)(()=>{!async function(){try{let e=await J.api.getIngredients();n(e),l(new Set(e.map(e=>e.id)))}catch(e){console.error("Failed to load ingredients:",e)}finally{a(!1)}}()},[]);let d=async()=>{let t=r.filter(e=>i.has(e.id));if(0!==t.length){c(!0);try{let a=await J.api.startCookingFromIngredients(t);e.push(`/cook?id=${a.id}`)}catch(e){console.error("Failed to start cooking:",e)}finally{c(!1)}}};return t?(0,s.jsx)("div",{className:"flex items-center justify-center min-h-[60vh]",children:(0,s.jsx)(b.k,{size:"lg",text:"Loading inventory..."})}):0===r.length?(0,s.jsxs)("div",{className:"text-center py-20",children:[(0,s.jsx)(p.A,{className:"w-12 h-12 text-slate-300 mx-auto mb-4"}),(0,s.jsx)("h2",{className:"text-xl font-bold",children:"No Ingredients Found"}),(0,s.jsx)("p",{className:"text-slate-600 dark:text-slate-400 mt-2",children:"Scan some ingredients first to start cooking"}),(0,s.jsx)(D.$,{onClick:()=>e.push("/scan"),className:"mt-4",children:"Go to Scanner"})]}):(0,s.jsxs)("div",{className:"max-w-4xl mx-auto p-6 space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"Cook from Inventory"}),(0,s.jsx)("p",{className:"text-slate-600 dark:text-slate-400 mt-2",children:"Select ingredients to generate a personalized recipe"})]}),(0,s.jsxs)(L.Zp,{className:"p-6",children:[(0,s.jsxs)("h3",{className:"font-bold mb-4",children:[i.size," of ",r.length," selected"]}),(0,s.jsx)("div",{className:"grid gap-3",children:r.map(e=>(0,s.jsxs)("label",{className:"flex items-center gap-3 p-3 bg-slate-50 dark:bg-slate-800 rounded-lg cursor-pointer hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors",children:[(0,s.jsx)("input",{type:"checkbox",checked:i.has(e.id),onChange:()=>{var t;return t=e.id,void l(e=>{let a=new Set(e);return a.has(t)?a.delete(t):a.add(t),a})},className:"w-5 h-5 text-brand-orange rounded"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("span",{className:"font-medium",children:e.name}),(0,s.jsxs)("span",{className:"text-sm text-slate-500 ml-2",children:[e.quantity," ",e.unit]})]})]},e.id))})]}),(0,s.jsx)(D.$,{onClick:d,disabled:o||0===i.size,size:"lg",className:"w-full",children:o?"Generating Recipe...":`Start Cooking with ${i.size} Ingredients`})]})}function K(){return(0,s.jsx)(f.Suspense,{fallback:(0,s.jsx)("div",{className:"flex items-center justify-center min-h-[60vh]",children:(0,s.jsx)(b.k,{size:"lg",text:"Loading cooking session..."})}),children:(0,s.jsx)(Y,{})})}},85389:(e,t,a)=>{Promise.resolve().then(a.bind(a,83485))},93842:(e,t,a)=>{"use strict";a.d(t,{p:()=>i,V:()=>l});var s=a(21555);function r(){return"u">typeof navigator&&void 0!==navigator.mediaDevices&&"function"==typeof navigator.mediaDevices.getUserMedia}function n(e){return"https:"===window.location.protocol||"localhost"===window.location.hostname||window.location.hostname.startsWith("127.")?r()?e instanceof Error?"NotAllowedError"===e.name||"PermissionDeniedError"===e.name?"Camera permission denied. Please allow camera access in your browser settings.":"NotFoundError"===e.name||"DevicesNotFoundError"===e.name?"No camera found on this device.":"NotReadableError"===e.name||"TrackStartError"===e.name?"Camera is already in use by another application.":"OverconstrainedError"===e.name||"ConstraintNotSatisfiedError"===e.name?"Camera does not meet the required specifications.":"TypeError"===e.name?"Camera access is not available. Please check your connection and browser settings.":e.message||"Failed to access camera":"Failed to access camera. Please check your browser permissions.":"Your browser does not support camera access. Please use a modern browser like Chrome, Safari, or Firefox.":"Camera access requires HTTPS. Please access the app via https:// instead of http://"}let i={ultraLow:{width:320,height:240,quality:.2},low:{width:480,height:360,quality:.3},medium:{width:640,height:480,quality:.5},high:{width:1280,height:720,quality:.7}};function l(e={}){let t=e.preset?i[e.preset]:null,{facingMode:a="environment",width:o=t?.width??480,height:c=t?.height??360,quality:d=t?.quality??.3}=e,u=(0,s.useRef)(null),h=(0,s.useRef)(null),m=(0,s.useRef)(null),[x,p]=(0,s.useState)(!1),[g,f]=(0,s.useState)(null),[b,y]=(0,s.useState)(null),v=(0,s.useCallback)(async()=>{try{if(f(null),!r()){let e=n();f(e),y(!1),console.error("Camera not supported:",e);return}let e=await navigator.mediaDevices.getUserMedia({video:{facingMode:a,width:{ideal:o},height:{ideal:c}}});m.current=e,u.current&&(u.current.srcObject=e,await u.current.play()),p(!0),y(!0)}catch(e){f(n(e)),y(!1),console.error("Camera error:",e)}},[a,o,c]),w=(0,s.useCallback)(()=>{m.current&&(m.current.getTracks().forEach(e=>e.stop()),m.current=null),u.current&&(u.current.srcObject=null),p(!1)},[]),j=(0,s.useCallback)(()=>{if(!u.current||!h.current)return console.warn("[Camera] Video or canvas ref not available"),null;let e=u.current,t=h.current;if(e.readyState<2)return console.warn("[Camera] Video not ready (readyState:",e.readyState,")"),null;if(0===e.videoWidth||0===e.videoHeight)return console.warn("[Camera] Video has no dimensions yet"),null;let a=t.getContext("2d");if(!a)return console.warn("[Camera] Could not get canvas context"),null;t.width=e.videoWidth||o,t.height=e.videoHeight||c,a.drawImage(e,0,0,t.width,t.height);try{return t.toDataURL("image/webp",d)}catch{return t.toDataURL("image/jpeg",d)}},[o,c,d]),N=(0,s.useCallback)(async(e=3e3)=>m.current?new Promise(t=>{let a=new MediaRecorder(m.current,{mimeType:"video/webm;codecs=vp8",videoBitsPerSecond:25e4}),s=[];a.ondataavailable=e=>{e.data.size>0&&s.push(e.data)},a.onstop=async()=>{let e=new Blob(s,{type:"video/webm"}),a=new FileReader;a.onloadend=()=>{t(a.result)},a.onerror=()=>{console.error("[Camera] Failed to convert video to base64"),t(null)},a.readAsDataURL(e)},a.start(),setTimeout(()=>{"recording"===a.state&&a.stop()},e)}):(console.warn("[Camera] No active stream for video recording"),null),[]);return(0,s.useEffect)(()=>()=>{w()},[w]),{videoRef:u,canvasRef:h,isActive:x,error:g,hasPermission:b,startCamera:v,stopCamera:w,captureFrame:j,captureVideo:N}}}},e=>{e.O(0,[9731,9631,7139,5101,1401,5885,9889,501,6939,1170,7358],()=>e(e.s=85389)),_N_E=e.O()}]);