(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2024],{20046:(e,s,t)=>{Promise.resolve().then(t.bind(t,32721))},31616:(e,s,t)=>{"use strict";t.d(s,{cn:()=>r});var a=t(43696),l=t(33086);function r(...e){return(0,l.QP)((0,a.$)(e))}},32721:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>A});var a=t(55155),l=t(73675),r=t(15749),n=t(62649),i=t(69979),c=t(57541),d=t(5762),o=t(44746),x=t(48345),h=t(50536),m=t(66119),u=t(57082),g=t(95389),f=t(24290),p=t(50497),b=t(21555),j=t(58915),v=t(33971),N=t(57809),w=t(88244),y=t(15885);function k(){let e=(0,p.useSearchParams)().get("id"),s=(0,p.useRouter)(),t=(0,w.d)(),[j,k]=(0,b.useState)(5),[A,C]=(0,b.useState)(""),[_,$]=(0,b.useState)(!1),[S,z]=(0,b.useState)(null),[P,I]=(0,b.useState)(null),[D,R]=(0,b.useState)(!1),[T,E]=(0,b.useState)(null),[F,O]=(0,b.useState)(!1),[Z,q]=(0,b.useState)(null),M=(0,b.useRef)(null),U=(0,b.useRef)(null),W=(0,b.useRef)(null),[B,H]=(0,b.useState)(!1);(0,b.useEffect)(()=>{!async function(){if(e)try{let s=await y.api.getCookingSession(e);if(s&&(z(s),s.recipe_id)){let e=await y.api.getRecipeById(s.recipe_id);I(e)}}catch(e){console.error("Failed to load session:",e)}}()},[e]);let G=async()=>{try{let e=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});U.current&&(U.current.srcObject=e,H(!0))}catch(e){console.error("Failed to access camera:",e),t.error("Camera unavailable","Please use file upload instead.")}},K=()=>{U.current?.srcObject&&(U.current.srcObject.getTracks().forEach(e=>e.stop()),U.current.srcObject=null,H(!1))},L=async()=>{if(T){O(!0);try{let e=T.split(",")[1],s=await y.api.analyzeDish(e,"image","media_resolution_high",{recipe_title:P?.title,difficulty:P?.difficulty});q(s.analysis)}catch(e){console.error("Failed to analyze dish:",e),t.error("Analysis failed","Could not analyze your dish. Please try again.")}finally{O(!1)}}},Q=async()=>{if(e){$(!0);try{await y.api.saveMeal(e,j,A),s.push("/history")}catch(e){console.error("Error saving meal:",e),t.error("Save failed","Could not save your meal. Please try again.")}finally{$(!1)}}};return e?(0,a.jsxs)("div",{className:"max-w-2xl mx-auto p-6 text-center space-y-8",children:[(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(i.A,{className:"w-10 h-10 text-green-600"})})}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h1",{className:"text-4xl font-black",children:"Bon Appetit!"}),(0,a.jsx)("p",{className:"text-slate-500 text-lg",children:P?`How did your ${P.title} turn out?`:"How did your AI-guided meal turn out?"})]}),(0,a.jsxs)(l.N,{mode:"wait",children:[!D&&!Z&&(0,a.jsx)(r.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:(0,a.jsx)(N.Zp,{className:"p-6 bg-gradient-to-r from-teal-50 to-orange-50 border-2 border-dashed border-teal-200 cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>R(!0),children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"p-3 bg-white rounded-xl shadow-sm",children:(0,a.jsx)(c.A,{className:"w-6 h-6 text-teal-500"})}),(0,a.jsxs)("div",{className:"flex-1 text-left",children:[(0,a.jsx)("h3",{className:"font-bold text-slate-800",children:"Kitchen Forensics"}),(0,a.jsx)("p",{className:"text-sm text-slate-500",children:"Take a photo of your dish for AI analysis and tips for next time"})]}),(0,a.jsx)(d.A,{className:"w-5 h-5 text-slate-400"})]})})}),D&&!Z&&(0,a.jsx)(r.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:(0,a.jsxs)(N.Zp,{className:"p-6 space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"font-bold text-lg",children:"Kitchen Forensics"}),(0,a.jsx)("button",{onClick:()=>{R(!1),E(null),K()},className:"p-1 hover:bg-slate-100 rounded-full",children:(0,a.jsx)(o.A,{className:"w-5 h-5 text-slate-400"})})]}),!T&&!B&&(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)(v.$,{onClick:G,className:"w-full",variant:"outline",children:[(0,a.jsx)(x.A,{className:"w-4 h-4 mr-2"}),"Take Photo"]}),(0,a.jsx)("p",{className:"text-xs text-slate-400",children:"or"}),(0,a.jsx)(v.$,{onClick:()=>M.current?.click(),variant:"ghost",className:"w-full",children:"Upload from Gallery"}),(0,a.jsx)("input",{ref:M,type:"file",accept:"image/*",className:"hidden",onChange:e=>{let s=e.target.files?.[0];if(!s)return;let t=new FileReader;t.onloadend=()=>{E(t.result)},t.readAsDataURL(s)}})]}),B&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"relative aspect-square bg-slate-900 rounded-xl overflow-hidden",children:[(0,a.jsx)("video",{ref:U,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover"}),(0,a.jsx)("canvas",{ref:W,className:"hidden"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(v.$,{onClick:K,variant:"outline",className:"flex-1",children:"Cancel"}),(0,a.jsxs)(v.$,{onClick:()=>{if(!U.current||!W.current)return;let e=U.current,s=W.current;s.width=e.videoWidth,s.height=e.videoHeight;let t=s.getContext("2d");t&&(t.drawImage(e,0,0),E(s.toDataURL("image/jpeg",.8)),K())},className:"flex-1",children:[(0,a.jsx)(x.A,{className:"w-4 h-4 mr-2"}),"Capture"]})]})]}),T&&!F&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"relative aspect-square bg-slate-100 rounded-xl overflow-hidden",children:[(0,a.jsx)("img",{src:T,alt:"Captured dish",className:"w-full h-full object-cover"}),(0,a.jsx)("button",{onClick:()=>E(null),className:"absolute top-2 right-2 p-1.5 bg-white/90 rounded-full shadow-lg",children:(0,a.jsx)(o.A,{className:"w-4 h-4"})})]}),(0,a.jsxs)(v.$,{onClick:L,className:"w-full",children:[(0,a.jsx)(c.A,{className:"w-4 h-4 mr-2"}),"Analyze My Dish"]})]}),F&&(0,a.jsx)("div",{className:"py-8 space-y-4",children:(0,a.jsxs)("div",{className:"relative aspect-square bg-slate-100 rounded-xl overflow-hidden",children:[(0,a.jsx)("img",{src:T,alt:"Analyzing dish",className:"w-full h-full object-cover"}),(0,a.jsx)("div",{className:"absolute inset-0 bg-slate-900/60 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center text-white space-y-2",children:[(0,a.jsx)(h.A,{className:"w-8 h-8 animate-spin mx-auto"}),(0,a.jsx)("p",{className:"font-bold",children:"AI Chef Analyzing..."}),(0,a.jsx)("p",{className:"text-sm opacity-80",children:"Checking doneness, presentation, technique"})]})})]})})]})}),Z&&(0,a.jsx)(r.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},children:(0,a.jsxs)(N.Zp,{className:"p-6 space-y-6 text-left",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"font-bold text-lg",children:"AI Chef Analysis"}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsxs)("span",{className:"text-3xl font-black text-orange-500",children:[Z.rating,"/10"]})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("span",{className:"text-sm text-slate-500",children:"Doneness:"}),(0,a.jsx)("span",{className:`px-3 py-1 rounded-full text-sm font-bold ${"perfect"===Z.doneness?"bg-green-100 text-green-700":"burnt"===Z.doneness?"bg-red-100 text-red-700":"overcooked"===Z.doneness?"bg-orange-100 text-orange-700":"bg-yellow-100 text-yellow-700"}`,children:Z.doneness.charAt(0).toUpperCase()+Z.doneness.slice(1)})]}),(0,a.jsx)("div",{className:"p-4 bg-slate-50 rounded-xl",children:(0,a.jsxs)("p",{className:"text-slate-700",children:["“",Z.critique,"”"]})}),Z.what_went_well.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(m.A,{className:"w-4 h-4 text-green-500"}),(0,a.jsx)("span",{className:"font-bold text-sm",children:"What Went Well"})]}),(0,a.jsx)("ul",{className:"space-y-1",children:Z.what_went_well.map((e,s)=>(0,a.jsxs)("li",{className:"text-sm text-slate-600 flex items-start gap-2",children:[(0,a.jsx)("span",{className:"text-green-500",children:"•"}),e]},s))})]}),Z.improvements.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(u.A,{className:"w-4 h-4 text-orange-500"}),(0,a.jsx)("span",{className:"font-bold text-sm",children:"Areas to Improve"})]}),(0,a.jsx)("ul",{className:"space-y-1",children:Z.improvements.map((e,s)=>(0,a.jsxs)("li",{className:"text-sm text-slate-600 flex items-start gap-2",children:[(0,a.jsx)("span",{className:"text-orange-500",children:"•"}),e]},s))})]}),Z.next_time_tips.length>0&&(0,a.jsxs)("div",{className:"p-4 bg-teal-50 rounded-xl",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(g.A,{className:"w-4 h-4 text-teal-600"}),(0,a.jsx)("span",{className:"font-bold text-sm text-teal-700",children:"Next Time"})]}),(0,a.jsx)("ul",{className:"space-y-1",children:Z.next_time_tips.map((e,s)=>(0,a.jsxs)("li",{className:"text-sm text-teal-700 flex items-start gap-2",children:[(0,a.jsxs)("span",{children:[s+1,"."]}),e]},s))})]}),(0,a.jsx)(v.$,{variant:"ghost",onClick:()=>{q(null),E(null),R(!1)},className:"w-full",children:"Done with Analysis"})]})})]}),(0,a.jsxs)(N.Zp,{className:"p-8 space-y-6 text-left",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-slate-600 mb-3",children:"Rate your experience"}),(0,a.jsx)("div",{className:"flex justify-center gap-2",children:[1,2,3,4,5].map(e=>(0,a.jsx)("button",{onClick:()=>k(e),className:"transition-transform hover:scale-110",children:(0,a.jsx)(f.A,{className:`w-10 h-10 ${j>=e?"fill-orange-500 text-orange-500":"text-slate-200"}`})},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-slate-600 mb-2",children:"Any notes on flavor or AI guidance?"}),(0,a.jsx)("textarea",{className:"w-full p-4 border rounded-xl h-32 resize-none focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:"e.g., 'The AI correctly spotted the pan was too hot!'",value:A,onChange:e=>C(e.target.value)})]}),(0,a.jsx)(v.$,{onClick:Q,disabled:_,className:"w-full h-12 text-lg",children:_?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.A,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):"Save to History"})]}),(0,a.jsx)(v.$,{variant:"ghost",onClick:()=>s.push("/"),children:"Skip for now"})]}):(0,a.jsxs)("div",{className:"text-center py-20",children:[(0,a.jsx)(n.A,{className:"w-12 h-12 text-slate-300 mx-auto mb-4"}),(0,a.jsx)("h2",{className:"text-xl font-bold",children:"No session ID provided"}),(0,a.jsx)(v.$,{variant:"ghost",onClick:()=>s.push("/"),className:"mt-4",children:"Go to Dashboard"})]})}function A(){return(0,a.jsx)(b.Suspense,{fallback:(0,a.jsx)("div",{className:"flex items-center justify-center min-h-[60vh]",children:(0,a.jsx)(j.k,{size:"lg"})}),children:(0,a.jsx)(k,{})})}},33971:(e,s,t)=>{"use strict";t.d(s,{$:()=>c,r:()=>i});var a=t(55155),l=t(3456),r=t(47426),n=t(31616);let i=(0,r.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-xl text-sm font-bold transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:ring-2 focus-visible:ring-orange-500 focus-visible:ring-offset-2",{variants:{variant:{default:"bg-orange-500 text-white hover:bg-orange-600 shadow-md shadow-orange-200 dark:shadow-orange-900/20",destructive:"bg-red-500 text-white hover:bg-red-600 shadow-md shadow-red-200 dark:shadow-red-900/20",outline:"border-2 border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 text-slate-900 dark:text-white hover:bg-slate-50 dark:hover:bg-slate-800 hover:border-slate-300 dark:hover:border-slate-600",secondary:"bg-slate-100 dark:bg-slate-800 text-slate-900 dark:text-white hover:bg-slate-200 dark:hover:bg-slate-700",ghost:"hover:bg-slate-100 dark:hover:bg-slate-800 text-slate-900 dark:text-white",link:"text-orange-500 dark:text-orange-400 underline-offset-4 hover:underline"},size:{default:"h-11 px-5 py-2",sm:"h-9 rounded-lg px-3 text-xs",lg:"h-14 rounded-2xl px-8 text-base",icon:"size-10"}},defaultVariants:{variant:"default",size:"default"}});function c({className:e,variant:s,size:t,asChild:r=!1,...c}){let d=r?l.DX:"button";return(0,a.jsx)(d,{"data-slot":"button",className:(0,n.cn)(i({variant:s,size:t,className:e})),...c})}},57809:(e,s,t)=>{"use strict";t.d(s,{BT:()=>c,Wu:()=>d,ZB:()=>i,Zp:()=>r,aR:()=>n});var a=t(55155),l=t(31616);function r({className:e,...s}){return(0,a.jsx)("div",{"data-slot":"card",className:(0,l.cn)("bg-white dark:bg-slate-900 text-slate-900 dark:text-white flex flex-col gap-6 rounded-2xl border border-slate-200 dark:border-slate-800 py-6 shadow-sm",e),...s})}function n({className:e,...s}){return(0,a.jsx)("div",{"data-slot":"card-header",className:(0,l.cn)("flex flex-col gap-1.5 px-6",e),...s})}function i({className:e,...s}){return(0,a.jsx)("div",{"data-slot":"card-title",className:(0,l.cn)("leading-none font-bold tracking-tight text-xl",e),...s})}function c({className:e,...s}){return(0,a.jsx)("div",{"data-slot":"card-description",className:(0,l.cn)("text-slate-600 dark:text-slate-400 text-sm",e),...s})}function d({className:e,...s}){return(0,a.jsx)("div",{"data-slot":"card-content",className:(0,l.cn)("px-6",e),...s})}},58915:(e,s,t)=>{"use strict";t.d(s,{k:()=>l});var a=t(55155);function l({size:e="md",text:s="AI is Thinking..."}){return(0,a.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,a.jsxs)("div",{className:`relative ${{sm:"w-8 h-8",md:"w-12 h-12",lg:"w-16 h-16"}[e]}`,children:[(0,a.jsx)("div",{className:"absolute inset-0 border-4 border-orange-200 rounded-full"}),(0,a.jsx)("div",{className:"absolute inset-0 border-4 border-orange-500 rounded-full border-t-transparent animate-spin"})]}),s&&(0,a.jsx)("p",{className:"text-xs font-bold uppercase tracking-widest text-orange-500 animate-pulse",children:s})]})}},88244:(e,s,t)=>{"use strict";t.d(s,{d:()=>x,t:()=>g});var a=t(55155),l=t(39156),r=t(62649),n=t(67649),i=t(75686),c=t(44746),d=t(21555);let o=(0,d.createContext)(void 0);function x(){let e=(0,d.useContext)(o);if(!e)throw Error("useToast must be used within a ToastProvider");return e}let h={success:l.A,error:r.A,warning:n.A,info:i.A},m={success:{bg:"bg-green-50 dark:bg-green-500/10",border:"border-green-200 dark:border-green-500/20",icon:"text-green-500",title:"text-green-800 dark:text-green-200",message:"text-green-700 dark:text-green-300"},error:{bg:"bg-red-50 dark:bg-red-500/10",border:"border-red-200 dark:border-red-500/20",icon:"text-red-500",title:"text-red-800 dark:text-red-200",message:"text-red-700 dark:text-red-300"},warning:{bg:"bg-yellow-50 dark:bg-yellow-500/10",border:"border-yellow-200 dark:border-yellow-500/20",icon:"text-yellow-500",title:"text-yellow-800 dark:text-yellow-200",message:"text-yellow-700 dark:text-yellow-300"},info:{bg:"bg-blue-50 dark:bg-blue-500/10",border:"border-blue-200 dark:border-blue-500/20",icon:"text-blue-500",title:"text-blue-800 dark:text-blue-200",message:"text-blue-700 dark:text-blue-300"}};function u({toast:e,onRemove:s}){let t=h[e.type],l=m[e.type];return(0,d.useEffect)(()=>{let t=e.duration??5e3;if(t>0){let e=setTimeout(s,t);return()=>clearTimeout(e)}},[e.duration,s]),(0,a.jsxs)("div",{className:`${l.bg} ${l.border} border rounded-xl p-4 shadow-lg backdrop-blur-sm animate-slide-in-right flex items-start gap-3 max-w-sm w-full`,role:"alert","aria-live":"polite",children:[(0,a.jsx)(t,{className:`w-5 h-5 ${l.icon} flex-shrink-0 mt-0.5`}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:`font-medium text-sm ${l.title}`,children:e.title}),e.message&&(0,a.jsx)("p",{className:`text-sm mt-1 ${l.message}`,children:e.message})]}),(0,a.jsx)("button",{onClick:s,className:"p-1 hover:bg-black/5 dark:hover:bg-white/10 rounded-lg transition-colors flex-shrink-0","aria-label":"Dismiss notification",children:(0,a.jsx)(c.A,{className:"w-4 h-4 text-gray-400"})})]})}function g({children:e}){let[s,t]=(0,d.useState)([]),l=(0,d.useCallback)(e=>{let s=Math.random().toString(36).substring(2,9);t(t=>[...t,{...e,id:s}])},[]),r=(0,d.useCallback)(e=>{t(s=>s.filter(s=>s.id!==e))},[]),n=(0,d.useCallback)((e,s)=>l({type:"success",title:e,message:s}),[l]),i=(0,d.useCallback)((e,s)=>l({type:"error",title:e,message:s}),[l]),c=(0,d.useCallback)((e,s)=>l({type:"warning",title:e,message:s}),[l]),x=(0,d.useCallback)((e,s)=>l({type:"info",title:e,message:s}),[l]);return(0,a.jsxs)(o.Provider,{value:{toasts:s,addToast:l,removeToast:r,success:n,error:i,warning:c,info:x},children:[e,(0,a.jsx)("div",{className:"fixed bottom-4 right-4 z-[100] flex flex-col gap-2 pointer-events-none",role:"region","aria-label":"Notifications","aria-live":"polite",children:s.map(e=>(0,a.jsx)("div",{className:"pointer-events-auto",children:(0,a.jsx)(u,{toast:e,onRemove:()=>r(e.id)})},e.id))})]})}}},e=>{e.O(0,[9731,9631,7139,5101,9384,5885,6939,1170,7358],()=>e(e.s=20046)),_N_E=e.O()}]);