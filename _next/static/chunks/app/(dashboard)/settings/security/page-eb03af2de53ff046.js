(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1297],{7769:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(18889).A)("key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]])},11778:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(18889).A)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]])},13851:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(18889).A)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},18889:(e,t,a)=>{"use strict";a.d(t,{A:()=>d});var r=a(21555);let s=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},l=(...e)=>e.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim();var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=(0,r.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:a=2,absoluteStrokeWidth:s,className:n="",children:d,iconNode:o,...c},h)=>(0,r.createElement)("svg",{ref:h,...i,width:t,height:t,stroke:e,strokeWidth:s?24*Number(a)/Number(t):a,className:l("lucide",n),...!d&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(c)&&{"aria-hidden":"true"},...c},[...o.map(([e,t])=>(0,r.createElement)(e,t)),...Array.isArray(d)?d:[d]])),d=(e,t)=>{let a=(0,r.forwardRef)(({className:a,...i},d)=>(0,r.createElement)(n,{ref:d,iconNode:t,className:l(`lucide-${s(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,a),...i}));return a.displayName=s(e),a}},22951:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(18889).A)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},25699:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(18889).A)("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]])},25990:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(18889).A)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},36161:(e,t,a)=>{Promise.resolve().then(a.bind(a,36992))},36992:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>v});var r=a(55155),s=a(50536),l=a(44643),i=a(42757),n=a(39156),d=a(7769),o=a(11778),c=a(77187),h=a(45681),x=a(22951),m=a(37100),u=a(25699),g=a(13851),b=a(67649),p=a(25990),y=a(3948),f=a.n(y),w=a(50497),j=a(21555),N=a(69339),k=a(15885);function v(){let e=(0,w.useRouter)(),{authenticated:t,isReady:a,user:y}=(0,N.A)(),[v,A]=(0,j.useState)(!0),[C,S]=(0,j.useState)(null),[M,F]=(0,j.useState)(!1),[E,R]=(0,j.useState)(null),[V,L]=(0,j.useState)(0),[P,O]=(0,j.useState)("main"),[q,_]=(0,j.useState)("intro"),[U,T]=(0,j.useState)(null),[z,I]=(0,j.useState)(null),[B,$]=(0,j.useState)(""),[D,G]=(0,j.useState)(""),[Y,H]=(0,j.useState)(!1),[W,K]=(0,j.useState)(null),[Q,Z]=(0,j.useState)(!1),[J,X]=(0,j.useState)(["","","","","",""]),ee=(0,j.useRef)([]),[et,ea]=(0,j.useState)(!1),[er,es]=(0,j.useState)([]),[el,ei]=(0,j.useState)(!1),[en,ed]=(0,j.useState)(!1),[eo,ec]=(0,j.useState)(!1),[eh,ex]=(0,j.useState)(null),[em,eu]=(0,j.useState)(""),[eg,eb]=(0,j.useState)(""),[ep,ey]=(0,j.useState)(!1),ef=(0,j.useCallback)(async()=>{try{let e=await k.api.getMFAMethod();if(S(e.method),F(e.setupCompleted),"totp"===e.method){let{data:e}=await k.api.getMFAFactors(),t=e?.totp?.[0];t&&"verified"===t.status&&R(t.id)}try{let e=await k.api.getRecoveryCodesCount();L(e)}catch{L(0)}}catch(e){console.error("Failed to load MFA status:",e)}finally{A(!1)}},[]);(0,j.useEffect)(()=>{if(a){if(!t)return void e.push("/login");ef()}},[a,t,e,ef]);let ew=async()=>{H(!0),G("");try{let{data:e,error:t}=await k.api.enrollMFA("AI Make Food");if(t||!e){G("Failed to start authenticator setup. Please try again."),H(!1);return}T(e.totp.qr_code),I(e.totp.secret),K(e.id),_("qr")}catch{G("Failed to start authenticator setup")}finally{H(!1)}},ej=async()=>{if(W&&6===B.length){H(!0),G("");try{let{data:e,error:t}=await k.api.challengeMFA(W);if(t||!e){G("Failed to create verification challenge"),H(!1);return}let{error:a}=await k.api.verifyMFA(W,e.id,B);if(a){G("Invalid code. Please try again."),$(""),H(!1);return}try{let e=await k.api.generateRecoveryCodes();es(e),_("recovery")}catch{_("complete")}}catch{G("Verification failed")}finally{H(!1)}}},eN=async()=>{H(!0);try{await k.api.setMFAMethod("totp"),O("main"),_("intro"),T(null),I(null),$(""),es([]),ef()}catch{G("Failed to complete setup")}finally{H(!1)}},ek=async()=>{H(!0),G("");try{let e=await k.api.sendEmailOTP("mfa_setup");e.success?Z(!0):G(e.error||"Failed to send verification code")}catch{G("Failed to send verification code")}finally{H(!1)}},ev=async e=>{let t=e||J.join("");if(6===t.length){H(!0),G("");try{let e=await k.api.verifyEmailOTP(t,"mfa_setup");if(!e.valid){G(e.error||"Invalid verification code"),X(["","","","","",""]),ee.current[0]?.focus(),H(!1);return}await k.api.setMFAMethod("email"),O("main"),Z(!1),X(["","","","","",""]),ef()}catch{G("Verification failed")}finally{H(!1)}}},eA=async()=>{if(6===em.length){ey(!0),eb("");try{if("totp"===C&&E){let{data:e,error:t}=await k.api.challengeMFA(E);if(t||!e){eb("Failed to verify current method"),ey(!1);return}let{error:a}=await k.api.verifyMFA(E,e.id,em);if(a){eb("Invalid code. Please try again."),eu(""),ey(!1);return}await k.api.unenrollMFA(E)}else if("email"===C){let e=await k.api.verifyEmailOTP(em,"method_switch");if(!e.valid){eb(e.error||"Invalid code. Please try again."),eu(""),ey(!1);return}}"totp"===eh?(O("setup-totp"),_("intro")):"email"===eh&&(O("setup-email"),Z(!1),X(["","","","","",""]))}catch{eb("Verification failed")}finally{ey(!1)}}},eC=async()=>{ey(!0),eb("");try{let e=await k.api.sendEmailOTP("method_switch");e.success||eb(e.error||"Failed to send verification code")}catch{eb("Failed to send verification code")}finally{ey(!1)}},eS=async()=>{ei(!0);try{let e=await k.api.generateRecoveryCodes();es(e),ed(!0),ef()}catch{}finally{ei(!1)}},eM=()=>{let e=new Blob([`AI Make Food - Recovery Codes
Generated: ${new Date().toISOString()}

Keep these codes in a safe place. Each code can only be used once.

${er.join("\n")}
`],{type:"text/plain"}),t=URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download="aimakefood-recovery-codes.txt",a.click(),URL.revokeObjectURL(t)},eF=()=>{navigator.clipboard.writeText(er.join("\n")),ec(!0),setTimeout(()=>ec(!1),2e3)},eE=()=>{O("main"),_("intro"),G(""),eb(""),T(null),I(null),$(""),Z(!1),X(["","","","","",""]),eu(""),ef()};return!a||v?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsx)(s.A,{className:"w-8 h-8 animate-spin text-brand-orange"})}):"setup-totp"===P?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-brand-dark py-8 px-4",children:(0,r.jsxs)("div",{className:"max-w-lg mx-auto",children:[(0,r.jsxs)("button",{onClick:eE,className:"flex items-center gap-2 text-gray-500 hover:text-brand-orange mb-6",children:[(0,r.jsx)(l.A,{className:"w-4 h-4"}),"Back to Security Settings"]}),(0,r.jsxs)("div",{className:"bg-white dark:bg-white/5 rounded-2xl shadow-xl border border-gray-200 dark:border-white/10 p-8",children:["intro"===q&&(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"w-20 h-20 bg-brand-teal/10 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,r.jsx)(i.A,{className:"w-10 h-10 text-brand-teal"})}),(0,r.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Set Up Authenticator App"}),(0,r.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:"Use an authenticator app like Google Authenticator or Authy for secure verification codes."}),(0,r.jsxs)("div",{className:"bg-gray-50 dark:bg-white/5 rounded-xl p-4 mb-6 text-left",children:[(0,r.jsx)("h3",{className:"font-semibold mb-2",children:"Benefits:"}),(0,r.jsxs)("ul",{className:"space-y-2 text-sm text-gray-600 dark:text-gray-300",children:[(0,r.jsxs)("li",{className:"flex items-center gap-2",children:[(0,r.jsx)(n.A,{className:"w-4 h-4 text-green-500"}),"Works offline"]}),(0,r.jsxs)("li",{className:"flex items-center gap-2",children:[(0,r.jsx)(n.A,{className:"w-4 h-4 text-green-500"}),"Most secure option"]}),(0,r.jsxs)("li",{className:"flex items-center gap-2",children:[(0,r.jsx)(n.A,{className:"w-4 h-4 text-green-500"}),"Codes refresh every 30 seconds"]})]})]}),D&&(0,r.jsx)("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-500/10 text-red-600 dark:text-red-400 rounded-lg text-sm",children:D}),(0,r.jsx)("button",{onClick:ew,disabled:Y,className:"w-full py-3 bg-gradient-to-r from-brand-orange to-brand-teal text-white rounded-xl font-semibold hover:shadow-lg transition-all disabled:opacity-50 flex items-center justify-center gap-2",children:Y?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.A,{className:"w-5 h-5 animate-spin"}),"Starting..."]}):"Continue"})]}),"qr"===q&&(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Scan QR Code"}),(0,r.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:"Open your authenticator app and scan this QR code."}),U&&(0,r.jsx)("div",{className:"bg-white p-4 rounded-xl inline-block mb-6",children:(0,r.jsx)("img",{src:U,alt:"QR Code",className:"w-48 h-48"})}),(0,r.jsxs)("div",{className:"bg-gray-50 dark:bg-white/5 rounded-xl p-4 mb-6",children:[(0,r.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:"Can't scan? Enter this code manually:"}),(0,r.jsx)("code",{className:"text-sm font-mono bg-gray-100 dark:bg-white/10 px-3 py-1 rounded break-all",children:z})]}),(0,r.jsx)("button",{onClick:()=>_("verify"),className:"w-full py-3 bg-gradient-to-r from-brand-orange to-brand-teal text-white rounded-xl font-semibold hover:shadow-lg transition-all",children:"I've Scanned the Code"})]}),"verify"===q&&(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Verify Setup"}),(0,r.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:"Enter the 6-digit code from your authenticator app."}),D&&(0,r.jsx)("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-500/10 text-red-600 dark:text-red-400 rounded-lg text-sm",children:D}),(0,r.jsx)("input",{type:"text",inputMode:"numeric",maxLength:6,value:B,onChange:e=>$(e.target.value.replace(/\D/g,"")),placeholder:"000000",className:"w-full px-4 py-3 text-center text-2xl font-mono tracking-widest border border-gray-200 dark:border-white/10 rounded-xl bg-white dark:bg-white/5 focus:ring-2 focus:ring-brand-orange/50 focus:outline-none mb-6"}),(0,r.jsx)("button",{onClick:ej,disabled:Y||6!==B.length,className:"w-full py-3 bg-gradient-to-r from-brand-orange to-brand-teal text-white rounded-xl font-semibold hover:shadow-lg transition-all disabled:opacity-50 flex items-center justify-center gap-2",children:Y?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.A,{className:"w-5 h-5 animate-spin"}),"Verifying..."]}):"Verify & Continue"})]}),"recovery"===q&&(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-yellow-100 dark:bg-yellow-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)(d.A,{className:"w-8 h-8 text-yellow-600"})}),(0,r.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Save Recovery Codes"}),(0,r.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:"Save these codes in a safe place. You can use them if you lose your authenticator."}),(0,r.jsx)("div",{className:"bg-gray-50 dark:bg-white/5 rounded-xl p-4 mb-6",children:(0,r.jsx)("div",{className:"grid grid-cols-2 gap-2",children:er.map((e,t)=>(0,r.jsx)("code",{className:"text-sm font-mono bg-white dark:bg-white/10 px-3 py-2 rounded",children:e},t))})}),(0,r.jsxs)("div",{className:"flex gap-3 mb-6",children:[(0,r.jsxs)("button",{onClick:eM,className:"flex-1 py-2 px-4 border border-gray-200 dark:border-white/10 rounded-lg flex items-center justify-center gap-2 hover:bg-gray-50 dark:hover:bg-white/5",children:[(0,r.jsx)(o.A,{className:"w-4 h-4"}),"Download"]}),(0,r.jsxs)("button",{onClick:eF,className:"flex-1 py-2 px-4 border border-gray-200 dark:border-white/10 rounded-lg flex items-center justify-center gap-2 hover:bg-gray-50 dark:hover:bg-white/5",children:[(0,r.jsx)(c.A,{className:"w-4 h-4"}),eo?"Copied!":"Copy"]})]}),(0,r.jsx)("button",{onClick:()=>_("complete"),className:"w-full py-3 bg-gradient-to-r from-brand-orange to-brand-teal text-white rounded-xl font-semibold hover:shadow-lg transition-all",children:"I've Saved My Codes"})]}),"complete"===q&&(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"w-20 h-20 bg-green-100 dark:bg-green-500/20 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,r.jsx)(n.A,{className:"w-10 h-10 text-green-500"})}),(0,r.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Authenticator Enabled!"}),(0,r.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:"Your account is now protected with authenticator app verification."}),(0,r.jsx)("button",{onClick:eN,disabled:Y,className:"w-full py-3 bg-gradient-to-r from-brand-orange to-brand-teal text-white rounded-xl font-semibold hover:shadow-lg transition-all disabled:opacity-50 flex items-center justify-center gap-2",children:Y?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.A,{className:"w-5 h-5 animate-spin"}),"Finishing..."]}):"Done"})]})]})]})}):"setup-email"===P?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-brand-dark py-8 px-4",children:(0,r.jsxs)("div",{className:"max-w-lg mx-auto",children:[(0,r.jsxs)("button",{onClick:eE,className:"flex items-center gap-2 text-gray-500 hover:text-brand-orange mb-6",children:[(0,r.jsx)(l.A,{className:"w-4 h-4"}),"Back to Security Settings"]}),(0,r.jsx)("div",{className:"bg-white dark:bg-white/5 rounded-2xl shadow-xl border border-gray-200 dark:border-white/10 p-8",children:Q?(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Enter Verification Code"}),(0,r.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:"Enter the 6-digit code we sent to your email."}),D&&(0,r.jsx)("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-500/10 text-red-600 dark:text-red-400 rounded-lg text-sm",children:D}),(0,r.jsx)("div",{className:"flex justify-center gap-2 mb-6",children:J.map((e,t)=>(0,r.jsx)("input",{ref:e=>{ee.current[t]=e},type:"text",inputMode:"numeric",maxLength:1,value:e,onChange:e=>((e,t)=>{if(!/^\d*$/.test(t))return;let a=[...J];a[e]=t.slice(-1),X(a),G(""),t&&e<5&&ee.current[e+1]?.focus(),a.every(e=>""!==e)&&6===a.join("").length&&ev(a.join(""))})(t,e.target.value),onKeyDown:e=>{"Backspace"===e.key&&!J[t]&&t>0&&ee.current[t-1]?.focus()},className:"w-12 h-14 text-center text-2xl font-bold border border-gray-200 dark:border-white/10 rounded-xl bg-white dark:bg-white/5 focus:ring-2 focus:ring-brand-orange/50 focus:outline-none"},t))}),(0,r.jsx)("button",{onClick:()=>ev(),disabled:Y||J.some(e=>""===e),className:"w-full py-3 bg-gradient-to-r from-brand-orange to-brand-teal text-white rounded-xl font-semibold hover:shadow-lg transition-all disabled:opacity-50 flex items-center justify-center gap-2",children:Y?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.A,{className:"w-5 h-5 animate-spin"}),"Verifying..."]}):"Verify & Enable"}),(0,r.jsx)("button",{onClick:ek,disabled:Y,className:"mt-4 text-sm text-brand-orange hover:underline",children:"Resend code"})]}):(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"w-20 h-20 bg-brand-orange/10 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,r.jsx)(h.A,{className:"w-10 h-10 text-brand-orange"})}),(0,r.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Set Up Email Verification"}),(0,r.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:"We'll send verification codes to your email when you sign in."}),(0,r.jsxs)("div",{className:"bg-gray-50 dark:bg-white/5 rounded-xl p-4 mb-6",children:[(0,r.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Verification codes will be sent to:"}),(0,r.jsx)("p",{className:"font-semibold",children:y?.email})]}),D&&(0,r.jsx)("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-500/10 text-red-600 dark:text-red-400 rounded-lg text-sm",children:D}),(0,r.jsx)("button",{onClick:ek,disabled:Y,className:"w-full py-3 bg-gradient-to-r from-brand-orange to-brand-teal text-white rounded-xl font-semibold hover:shadow-lg transition-all disabled:opacity-50 flex items-center justify-center gap-2",children:Y?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.A,{className:"w-5 h-5 animate-spin"}),"Sending..."]}):"Send Verification Code"})]})})]})}):"switch-method"===P?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-brand-dark py-8 px-4",children:(0,r.jsxs)("div",{className:"max-w-lg mx-auto",children:[(0,r.jsxs)("button",{onClick:eE,className:"flex items-center gap-2 text-gray-500 hover:text-brand-orange mb-6",children:[(0,r.jsx)(l.A,{className:"w-4 h-4"}),"Back to Security Settings"]}),(0,r.jsx)("div",{className:"bg-white dark:bg-white/5 rounded-2xl shadow-xl border border-gray-200 dark:border-white/10 p-8",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-brand-orange/10 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)(x.A,{className:"w-8 h-8 text-brand-orange"})}),(0,r.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Verify Your Current Method"}),(0,r.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:"totp"===C?"Enter a code from your authenticator app to continue.":"Enter the code we sent to your email to continue."}),"email"===C&&(0,r.jsx)("button",{onClick:eC,disabled:ep,className:"mb-4 px-4 py-2 text-sm bg-gray-100 dark:bg-white/10 rounded-lg hover:bg-gray-200 dark:hover:bg-white/20",children:ep?"Sending...":"Send verification code"}),eg&&(0,r.jsx)("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-500/10 text-red-600 dark:text-red-400 rounded-lg text-sm",children:eg}),(0,r.jsx)("input",{type:"text",inputMode:"numeric",maxLength:6,value:em,onChange:e=>eu(e.target.value.replace(/\D/g,"")),placeholder:"000000",className:"w-full px-4 py-3 text-center text-2xl font-mono tracking-widest border border-gray-200 dark:border-white/10 rounded-xl bg-white dark:bg-white/5 focus:ring-2 focus:ring-brand-orange/50 focus:outline-none mb-6"}),(0,r.jsxs)("div",{className:"flex items-center gap-3 text-sm text-gray-500 mb-6",children:[(0,r.jsxs)("span",{className:"flex items-center gap-1",children:["totp"===C?(0,r.jsx)(i.A,{className:"w-4 h-4"}):(0,r.jsx)(h.A,{className:"w-4 h-4"}),"totp"===C?"Authenticator":"Email"]}),(0,r.jsx)(m.A,{className:"w-4 h-4"}),(0,r.jsxs)("span",{className:"flex items-center gap-1",children:["totp"===eh?(0,r.jsx)(i.A,{className:"w-4 h-4"}):(0,r.jsx)(h.A,{className:"w-4 h-4"}),"totp"===eh?"Authenticator":"Email"]})]}),(0,r.jsx)("button",{onClick:eA,disabled:ep||6!==em.length,className:"w-full py-3 bg-gradient-to-r from-brand-orange to-brand-teal text-white rounded-xl font-semibold hover:shadow-lg transition-all disabled:opacity-50 flex items-center justify-center gap-2",children:ep?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.A,{className:"w-5 h-5 animate-spin"}),"Verifying..."]}):"Verify & Continue"})]})})]})}):"recovery-codes"===P?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-brand-dark py-8 px-4",children:(0,r.jsxs)("div",{className:"max-w-lg mx-auto",children:[(0,r.jsxs)("button",{onClick:()=>{O("main"),es([]),ed(!1)},className:"flex items-center gap-2 text-gray-500 hover:text-brand-orange mb-6",children:[(0,r.jsx)(l.A,{className:"w-4 h-4"}),"Back to Security Settings"]}),(0,r.jsx)("div",{className:"bg-white dark:bg-white/5 rounded-2xl shadow-xl border border-gray-200 dark:border-white/10 p-8",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-brand-orange/10 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)(d.A,{className:"w-8 h-8 text-brand-orange"})}),(0,r.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Recovery Codes"}),(0,r.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:er.length>0?"Here are your new recovery codes. Save them in a safe place.":"Generate new recovery codes to access your account if you lose your verification method."}),er.length>0?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"bg-gray-50 dark:bg-white/5 rounded-xl p-4 mb-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsx)("span",{className:"text-sm text-gray-500",children:"Recovery Codes"}),(0,r.jsxs)("button",{onClick:()=>ed(!en),className:"text-sm text-brand-orange hover:underline flex items-center gap-1",children:[en?(0,r.jsx)(u.A,{className:"w-4 h-4"}):(0,r.jsx)(g.A,{className:"w-4 h-4"}),en?"Hide":"Show"]})]}),(0,r.jsx)("div",{className:"grid grid-cols-2 gap-2",children:er.map((e,t)=>(0,r.jsx)("code",{className:"text-sm font-mono bg-white dark:bg-white/10 px-3 py-2 rounded",children:en?e:"********"},t))})]}),(0,r.jsxs)("div",{className:"flex gap-3 mb-6",children:[(0,r.jsxs)("button",{onClick:eM,className:"flex-1 py-2 px-4 border border-gray-200 dark:border-white/10 rounded-lg flex items-center justify-center gap-2 hover:bg-gray-50 dark:hover:bg-white/5",children:[(0,r.jsx)(o.A,{className:"w-4 h-4"}),"Download"]}),(0,r.jsxs)("button",{onClick:eF,className:"flex-1 py-2 px-4 border border-gray-200 dark:border-white/10 rounded-lg flex items-center justify-center gap-2 hover:bg-gray-50 dark:hover:bg-white/5",children:[(0,r.jsx)(c.A,{className:"w-4 h-4"}),eo?"Copied!":"Copy"]})]})]}):(0,r.jsx)("div",{className:"bg-yellow-50 dark:bg-yellow-500/10 border border-yellow-200 dark:border-yellow-500/20 rounded-xl p-4 mb-6 text-left",children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)(b.A,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium text-yellow-800 dark:text-yellow-200",children:"Warning"}),(0,r.jsx)("p",{className:"text-sm text-yellow-700 dark:text-yellow-300 mt-1",children:"Generating new codes will invalidate all existing recovery codes."})]})]})}),(0,r.jsx)("button",{onClick:eS,disabled:el,className:"w-full py-3 bg-gradient-to-r from-brand-orange to-brand-teal text-white rounded-xl font-semibold hover:shadow-lg transition-all disabled:opacity-50 flex items-center justify-center gap-2",children:el?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.A,{className:"w-5 h-5 animate-spin"}),"Generating..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.A,{className:"w-5 h-5"}),er.length>0?"Regenerate Codes":"Generate Recovery Codes"]})})]})})]})}):(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-brand-dark py-8 px-4",children:(0,r.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,r.jsxs)(f(),{href:"/settings",className:"flex items-center gap-2 text-gray-500 hover:text-brand-orange mb-6",children:[(0,r.jsx)(l.A,{className:"w-4 h-4"}),"Back to Settings"]}),(0,r.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Account Security"}),(0,r.jsx)("div",{className:"bg-white dark:bg-white/5 rounded-2xl shadow-xl border border-gray-200 dark:border-white/10 p-6 mb-6",children:(0,r.jsxs)("div",{className:"flex items-start gap-4",children:[(0,r.jsx)("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center flex-shrink-0 ${"totp"===C?"bg-brand-teal/10":"bg-brand-orange/10"}`,children:"totp"===C?(0,r.jsx)(i.A,{className:"w-6 h-6 text-brand-teal"}):"email"===C?(0,r.jsx)(h.A,{className:"w-6 h-6 text-brand-orange"}):(0,r.jsx)(x.A,{className:"w-6 h-6 text-gray-400"})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold",children:"Two-Factor Authentication"}),M?(0,r.jsxs)("span",{className:"flex items-center gap-1 text-sm text-green-600 dark:text-green-400",children:[(0,r.jsx)(n.A,{className:"w-4 h-4"}),"Enabled"]}):(0,r.jsxs)("span",{className:"flex items-center gap-1 text-sm text-yellow-600 dark:text-yellow-400",children:[(0,r.jsx)(b.A,{className:"w-4 h-4"}),"Required"]})]}),(0,r.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-sm mb-4",children:M?"totp"===C?"Your account is protected with an authenticator app.":"Your account is protected with email verification codes.":"Two-factor authentication is required for your account security."}),M?(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,r.jsx)("span",{className:"text-gray-500",children:"Current method:"}),(0,r.jsx)("span",{className:"font-medium flex items-center gap-1",children:"totp"===C?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.A,{className:"w-4 h-4"}),"Authenticator App"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(h.A,{className:"w-4 h-4"}),"Email Verification"]})})]}),(0,r.jsxs)("button",{onClick:()=>{ex("totp"===C?"email":"totp"),eb(""),eu(""),O("switch-method")},className:"px-4 py-2 border border-gray-200 dark:border-white/10 rounded-lg hover:bg-gray-50 dark:hover:bg-white/5 transition-colors text-sm flex items-center gap-2",children:[(0,r.jsx)(p.A,{className:"w-4 h-4"}),"Switch to"," ","totp"===C?"Email Verification":"Authenticator App"]})]}):(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsxs)("button",{onClick:()=>O("setup-totp"),className:"px-4 py-2 bg-gradient-to-r from-brand-orange to-brand-teal text-white rounded-lg hover:shadow-lg transition-all text-sm flex items-center gap-2",children:[(0,r.jsx)(i.A,{className:"w-4 h-4"}),"Set Up Authenticator"]}),(0,r.jsxs)("button",{onClick:()=>O("setup-email"),className:"px-4 py-2 border border-gray-200 dark:border-white/10 rounded-lg hover:bg-gray-50 dark:hover:bg-white/5 transition-colors text-sm flex items-center gap-2",children:[(0,r.jsx)(h.A,{className:"w-4 h-4"}),"Set Up Email"]})]})]})]})}),M&&"totp"===C&&(0,r.jsx)("div",{className:"bg-white dark:bg-white/5 rounded-2xl shadow-xl border border-gray-200 dark:border-white/10 p-6",children:(0,r.jsxs)("div",{className:"flex items-start gap-4",children:[(0,r.jsx)("div",{className:"w-12 h-12 bg-brand-teal/10 rounded-xl flex items-center justify-center flex-shrink-0",children:(0,r.jsx)(d.A,{className:"w-6 h-6 text-brand-teal"})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"Recovery Codes"}),(0,r.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-sm mb-4",children:V>0?`You have ${V} recovery codes remaining.`:"Generate backup codes to access your account if you lose your authenticator."}),(0,r.jsxs)("button",{onClick:()=>O("recovery-codes"),className:"px-4 py-2 border border-gray-200 dark:border-white/10 rounded-lg hover:bg-gray-50 dark:hover:bg-white/5 transition-colors flex items-center gap-2",children:[(0,r.jsx)(d.A,{className:"w-4 h-4"}),V>0?"Manage Recovery Codes":"Generate Recovery Codes"]})]})]})}),(0,r.jsx)("div",{className:"mt-6 p-4 bg-blue-50 dark:bg-blue-500/10 border border-blue-200 dark:border-blue-500/20 rounded-xl",children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)(x.A,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium text-blue-800 dark:text-blue-200 text-sm",children:"Two-factor authentication is required"}),(0,r.jsx)("p",{className:"text-sm text-blue-700 dark:text-blue-300 mt-1",children:"For your security, all AI Make Food accounts require two-factor authentication. You can switch between authenticator app and email verification, but cannot disable 2FA entirely."})]})]})})]})})}},37100:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(18889).A)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},39156:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(18889).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},42757:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(18889).A)("smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]])},44643:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(18889).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},45681:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(18889).A)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]])},50497:(e,t,a)=>{"use strict";var r=a(60685);a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})},50536:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(18889).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},67649:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(18889).A)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},69339:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var r=a(21555),s=a(15885);function l(){let[e,t]=(0,r.useState)(null),[a,l]=(0,r.useState)(!0),[i,n]=(0,r.useState)(!1),[d,o]=(0,r.useState)(null),c=(0,r.useCallback)(async()=>{try{let e=(0,s.getSupabase)(),{data:a,error:r}=await e.auth.refreshSession();if(r)return console.error("[useAuth] Refresh error:",r),!1;if(!a?.session)return console.error("[useAuth] No session returned after refresh"),!1;return o(a.session),t(a.session.user),console.log("[useAuth] Session refreshed successfully"),!0}catch(e){return console.error("[useAuth] Failed to refresh:",e),!1}},[]);return(0,r.useEffect)(()=>{s.api.getUser().then(({data:{user:e}})=>{t(e),l(!1),n(!0)}).catch(()=>{l(!1),n(!0)});let{data:{subscription:e}}=s.api.onAuthStateChange(async(e,a)=>{console.log("[useAuth] Auth state change:",e),"TOKEN_REFRESHED"===e&&console.log("[useAuth] Token refreshed successfully"),o(a),t(a?.user??null),l(!1),n(!0)});return()=>e.unsubscribe()},[]),{user:e,session:d,loading:a,isReady:i,authenticated:!!e,refreshSession:c,signOut:()=>s.api.signOut()}}},77187:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(18889).A)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]])}},e=>{e.O(0,[9731,9631,3948,5885,6939,1170,7358],()=>e(e.s=36161)),_N_E=e.O()}]);