(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[317],{28975:(e,t,a)=>{Promise.resolve().then(a.bind(a,29185))},29185:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>ez});var s=a(55155),r=a(21555),l=a(3948),n=a.n(l),o=a(22951),i=a(88324),d=a(95382),c=a(77636),x=a(64119),m=a(78562),u=a(58039),h=a(52830),b=a(67649),p=a(95389),g=a(69811),f=a(33971),k=a(47963),y=a(15885);let v={events_by_date:[],events_by_type:[],severity_distribution:[],response_times:[],summary:{total_events:0,avg_response_seconds:0,most_common_type:null,improvement_percentage:0}};var j=a(45723),w=a(62649),N=a(50536),_=a(31616);let S={fire_hazard:{type:"fire_hazard",label:"Fire Hazard",shortLabel:"Fire",icon:"\uD83D\uDD25",color:"#dc2626"},burn_prevention:{type:"burn_prevention",label:"Burn Prevention",shortLabel:"Burn",icon:"♨️",color:"#ea580c"},boiling_alert:{type:"boiling_alert",label:"Boiling Alert",shortLabel:"Boiling",icon:"\uD83D\uDCA8",color:"#eab308"},child_safety:{type:"child_safety",label:"Child Safety",shortLabel:"Child",icon:"\uD83D\uDC76",color:"#dc2626"},pet_safety:{type:"pet_safety",label:"Pet Safety",shortLabel:"Pet",icon:"\uD83D\uDC3E",color:"#ea580c"},hot_surface:{type:"hot_surface",label:"Hot Surface",shortLabel:"Hot",icon:"\uD83C\uDF21️",color:"#f97316"},knife_technique:{type:"knife_technique",label:"Knife Technique",shortLabel:"Knife",icon:"\uD83D\uDD2A",color:"#3b82f6"},cross_contamination:{type:"cross_contamination",label:"Cross Contamination",shortLabel:"Hygiene",icon:"\uD83E\uDDA0",color:"#8b5cf6"},away_too_long:{type:"away_too_long",label:"Away Too Long",shortLabel:"Away",icon:"\uD83D\uDEB6",color:"#f59e0b"},attention_needed:{type:"attention_needed",label:"Attention Needed",shortLabel:"Attention",icon:"\uD83D\uDC4B",color:"#6366f1"}},C={critical:{severity:"critical",label:"CRITICAL",color:"#dc2626",bgColor:"bg-red-100 dark:bg-red-900/30",textColor:"text-red-700 dark:text-red-300"},safety:{severity:"safety",label:"SAFETY",color:"#ea580c",bgColor:"bg-orange-100 dark:bg-orange-900/30",textColor:"text-orange-700 dark:text-orange-300"},warning:{severity:"warning",label:"Warning",color:"#eab308",bgColor:"bg-yellow-100 dark:bg-yellow-900/30",textColor:"text-yellow-700 dark:text-yellow-300"},info:{severity:"info",label:"Info",color:"#3b82f6",bgColor:"bg-blue-100 dark:bg-blue-900/30",textColor:"text-blue-700 dark:text-blue-300"}};function A(e){if(e<60)return`${Math.round(e)} sec`;let t=Math.floor(e/60),a=Math.round(e%60);if(t<60)return a>0?`${t}m ${a}s`:`${t} min`;let s=Math.floor(t/60);return`${s}h ${t%60}m`}function E(e){return({today:"Today",yesterday:"Yesterday",week:"This Week","7days":"Last 7 Days","2weeks":"Last 2 Weeks","14days":"Last 14 Days",month:"This Month","30days":"Last 30 Days"})[e]||e}var D=a(66141),L=a(53101),T=a(35389),z=a(93766),F=a(60616),R=a(89136),$=a(16327),M=a(44746),W=a(33444);let I={fire_hazard:D.A,burn_prevention:L.A,boiling_alert:T.A,child_safety:z.A,pet_safety:F.A,hot_surface:L.A,knife_technique:b.A,cross_contamination:R.A,away_too_long:$.A,attention_needed:b.A},H={fire_hazard:"Fire Hazard",burn_prevention:"Burn Prevention",boiling_alert:"Boiling Alert",child_safety:"Child Safety",pet_safety:"Pet Safety",hot_surface:"Hot Surface",knife_technique:"Knife Technique",cross_contamination:"Cross Contamination",away_too_long:"Away Too Long",attention_needed:"Attention Needed"};function P(e){return new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}function K(e,t){if(!t.trim())return e;let a=RegExp(`(${t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return e.split(a).map((e,t)=>a.test(e)?(0,s.jsx)("mark",{className:"bg-yellow-200 dark:bg-yellow-800 rounded px-0.5",children:e},t):e)}function q({event:e,onClear:t,highlightText:a,className:l}){let n=I[e.hazard_type]||b.A,o=C[e.severity],i=H[e.hazard_type]||e.hazard_type,d=(0,r.useMemo)(()=>(function(e,t){if(!t)return null;let a=new Date(e).getTime();return(new Date(t).getTime()-a)/1e3})(e.created_at,e.acknowledged_at),[e.created_at,e.acknowledged_at]);return(0,s.jsxs)("div",{className:(0,_.cn)("relative overflow-hidden rounded-xl border bg-white dark:bg-slate-900 transition-all","hover:shadow-md","critical"===e.severity&&"border-red-200 dark:border-red-800","safety"===e.severity&&"border-orange-200 dark:border-orange-800","warning"===e.severity&&"border-yellow-200 dark:border-yellow-800","info"===e.severity&&"border-blue-200 dark:border-blue-800",l),children:[(0,s.jsx)("div",{className:(0,_.cn)("absolute top-0 left-0 w-1 h-full","critical"===e.severity&&"bg-red-500","safety"===e.severity&&"bg-orange-500","warning"===e.severity&&"bg-yellow-500","info"===e.severity&&"bg-blue-500")}),(0,s.jsxs)("div",{className:"p-4 pl-5",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between gap-3 mb-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:(0,_.cn)("p-2 rounded-lg",o?.bgColor||"bg-slate-100 dark:bg-slate-800"),children:(0,s.jsx)(n,{className:(0,_.cn)("w-5 h-5",o?.textColor||"text-slate-600")})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsx)("span",{className:(0,_.cn)("text-xs font-bold uppercase tracking-wide",o?.textColor||"text-slate-600"),children:o?.label||e.severity})}),(0,s.jsx)("h3",{className:"font-medium text-slate-900 dark:text-white",children:i})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-xs text-slate-500 dark:text-slate-400 whitespace-nowrap",children:P(e.created_at)}),t&&(0,s.jsx)("button",{onClick:()=>t(e.id),className:"p-1 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-colors",title:"Remove from history",children:(0,s.jsx)(M.A,{className:"w-4 h-4 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300"})})]})]}),(0,s.jsx)("p",{className:"text-sm text-slate-700 dark:text-slate-300 mb-3",children:a?K(e.message,a):e.message}),e.voice_message&&e.voice_message!==e.message&&(0,s.jsxs)("p",{className:"text-xs text-slate-500 dark:text-slate-400 italic mb-3",children:['"',a?K(e.voice_message,a):e.voice_message,'"']}),(0,s.jsxs)("div",{className:"flex items-center gap-4 text-xs",children:[e.acknowledged&&null!==d&&(0,s.jsxs)("div",{className:"flex items-center gap-1 text-slate-600 dark:text-slate-400",children:[(0,s.jsx)(W.A,{className:"w-3.5 h-3.5"}),(0,s.jsxs)("span",{children:["Response: ",A(d)]})]}),e.acknowledged&&e.acknowledged_at&&(0,s.jsxs)("div",{className:"flex items-center gap-1 text-green-600 dark:text-green-400",children:[(0,s.jsx)(m.A,{className:"w-3.5 h-3.5"}),(0,s.jsxs)("span",{children:["Acknowledged: ",P(e.acknowledged_at)]})]}),!e.acknowledged&&(0,s.jsxs)("div",{className:"flex items-center gap-1 text-amber-600 dark:text-amber-400",children:[(0,s.jsx)(b.A,{className:"w-3.5 h-3.5"}),(0,s.jsx)("span",{children:"Not yet acknowledged"})]})]})]})]})}var B=a(57798),U=a(25990),Y=a(792),G=a(38268);let O=["today","yesterday","7days","month"],Q=["fire_hazard","burn_prevention","boiling_alert","child_safety","pet_safety","hot_surface","knife_technique","cross_contamination","away_too_long","attention_needed"];function J({searchQuery:e,onSearchChange:t,hazardTypeFilters:a,onHazardTypeFiltersChange:l,datePreset:n,onDatePresetChange:o,dateRange:i,onDateRangeChange:d,activeFilterCount:c,onClearAllFilters:x,onRefresh:m,isLoading:u=!1,className:b}){let[p,g]=(0,r.useState)(e),[f,k]=(0,r.useState)(!1),[y,v]=(0,r.useState)(!1),[j,w]=(0,r.useState)(""),[N,C]=(0,r.useState)(""),A=(0,r.useRef)(null),D=(0,r.useRef)(null),L=function(e,t){let[a,s]=(0,r.useState)(e);return(0,r.useEffect)(()=>{let t=setTimeout(()=>{s(e)},300);return()=>{clearTimeout(t)}},[e,300]),a}(p,0);(0,r.useEffect)(()=>{L!==e&&t(L)},[L,e,t]),(0,r.useEffect)(()=>{e!==p&&""===e&&g("")},[e,p]),(0,r.useEffect)(()=>{function e(e){A.current&&!A.current.contains(e.target)&&k(!1),D.current&&!D.current.contains(e.target)&&v(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let T=(0,r.useCallback)(e=>{a.includes(e)?l(a.filter(t=>t!==e)):l([...a,e])},[a,l]),z=(0,r.useCallback)(()=>{if(j&&N){let e=new Date(j);e.setHours(0,0,0,0);let t=new Date(N);t.setHours(23,59,59,999),d({start:e,end:t}),k(!1)}},[j,N,d]),F=e=>e.toLocaleDateString("en-US",{month:"short",day:"numeric"});return(0,s.jsxs)("div",{className:(0,_.cn)("space-y-3",b),children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("div",{className:"relative flex-1",children:[(0,s.jsx)(B.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),(0,s.jsx)("input",{type:"text",placeholder:"Search events...",value:p,onChange:e=>g(e.target.value),className:(0,_.cn)("w-full pl-10 pr-10 py-2 rounded-lg border","bg-white dark:bg-slate-900","border-slate-200 dark:border-slate-700","text-slate-900 dark:text-white","placeholder:text-slate-400 dark:placeholder:text-slate-500","focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent")}),p&&(0,s.jsx)("button",{onClick:()=>g(""),className:"absolute right-3 top-1/2 -translate-y-1/2 p-1 hover:bg-slate-100 dark:hover:bg-slate-800 rounded",children:(0,s.jsx)(M.A,{className:"w-3 h-3 text-slate-400"})})]}),(0,s.jsx)("button",{onClick:m,disabled:u,className:(0,_.cn)("p-2 rounded-lg border","bg-white dark:bg-slate-900","border-slate-200 dark:border-slate-700","hover:bg-slate-50 dark:hover:bg-slate-800","disabled:opacity-50 disabled:cursor-not-allowed","transition-colors"),title:"Refresh events",children:(0,s.jsx)(U.A,{className:(0,_.cn)("w-4 h-4 text-slate-600 dark:text-slate-400",u&&"animate-spin")})})]}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,s.jsxs)("div",{className:"relative",ref:D,children:[(0,s.jsxs)("button",{onClick:()=>v(!y),className:(0,_.cn)("flex items-center gap-2 px-3 py-1.5 rounded-lg border text-sm","bg-white dark:bg-slate-900",a.length>0?"border-blue-300 dark:border-blue-700 text-blue-700 dark:text-blue-300":"border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-400","hover:bg-slate-50 dark:hover:bg-slate-800","transition-colors"),children:[(0,s.jsx)(h.A,{className:"w-3.5 h-3.5"}),(0,s.jsx)("span",{children:"Type"}),a.length>0&&(0,s.jsx)("span",{className:"px-1.5 py-0.5 text-xs bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded",children:a.length}),(0,s.jsx)(Y.A,{className:"w-3.5 h-3.5"})]}),y&&(0,s.jsx)("div",{className:(0,_.cn)("absolute top-full left-0 mt-1 z-50","w-64 max-h-72 overflow-y-auto","bg-white dark:bg-slate-900","border border-slate-200 dark:border-slate-700","rounded-lg shadow-lg"),children:(0,s.jsx)("div",{className:"p-2 space-y-1",children:Q.map(e=>{let t=S[e],r=a.includes(e);return(0,s.jsxs)("button",{onClick:()=>T(e),className:(0,_.cn)("w-full flex items-center gap-2 px-2 py-1.5 rounded text-sm text-left",r?"bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300":"hover:bg-slate-50 dark:hover:bg-slate-800 text-slate-700 dark:text-slate-300"),children:[(0,s.jsx)("span",{children:t.icon}),(0,s.jsx)("span",{className:"flex-1",children:t.label}),r&&(0,s.jsx)("span",{className:"text-blue-500",children:"✓"})]},e)})})})]}),(0,s.jsxs)("div",{className:"relative",ref:A,children:[(0,s.jsxs)("button",{onClick:()=>k(!f),className:(0,_.cn)("flex items-center gap-2 px-3 py-1.5 rounded-lg border text-sm","bg-white dark:bg-slate-900",n||i?"border-blue-300 dark:border-blue-700 text-blue-700 dark:text-blue-300":"border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-400","hover:bg-slate-50 dark:hover:bg-slate-800","transition-colors"),children:[(0,s.jsx)(G.A,{className:"w-3.5 h-3.5"}),(0,s.jsx)("span",{children:n?E(n):i?`${F(i.start)} - ${F(i.end)}`:"Date"}),(0,s.jsx)(Y.A,{className:"w-3.5 h-3.5"})]}),f&&(0,s.jsxs)("div",{className:(0,_.cn)("absolute top-full left-0 mt-1 z-50","w-64","bg-white dark:bg-slate-900","border border-slate-200 dark:border-slate-700","rounded-lg shadow-lg"),children:[(0,s.jsxs)("div",{className:"p-2 border-b border-slate-200 dark:border-slate-700",children:[(0,s.jsx)("p",{className:"text-xs font-medium text-slate-500 dark:text-slate-400 mb-2 px-2",children:"Quick Select"}),(0,s.jsx)("div",{className:"space-y-1",children:O.map(e=>(0,s.jsx)("button",{onClick:()=>{o(e),k(!1)},className:(0,_.cn)("w-full px-2 py-1.5 rounded text-sm text-left",n===e?"bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300":"hover:bg-slate-50 dark:hover:bg-slate-800 text-slate-700 dark:text-slate-300"),children:E(e)},e))})]}),(0,s.jsxs)("div",{className:"p-2",children:[(0,s.jsx)("p",{className:"text-xs font-medium text-slate-500 dark:text-slate-400 mb-2 px-2",children:"Custom Range"}),(0,s.jsxs)("div",{className:"space-y-2 px-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Start"}),(0,s.jsx)("input",{type:"date",value:j,onChange:e=>w(e.target.value),className:(0,_.cn)("w-full mt-1 px-2 py-1 rounded border text-sm","bg-white dark:bg-slate-800","border-slate-200 dark:border-slate-700","text-slate-900 dark:text-white")})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-slate-500 dark:text-slate-400",children:"End"}),(0,s.jsx)("input",{type:"date",value:N,onChange:e=>C(e.target.value),className:(0,_.cn)("w-full mt-1 px-2 py-1 rounded border text-sm","bg-white dark:bg-slate-800","border-slate-200 dark:border-slate-700","text-slate-900 dark:text-white")})]}),(0,s.jsx)("button",{onClick:z,disabled:!j||!N,className:(0,_.cn)("w-full py-1.5 rounded text-sm font-medium","bg-blue-500 text-white","hover:bg-blue-600","disabled:opacity-50 disabled:cursor-not-allowed","transition-colors"),children:"Apply"})]})]}),(n||i)&&(0,s.jsx)("div",{className:"p-2 border-t border-slate-200 dark:border-slate-700",children:(0,s.jsx)("button",{onClick:()=>{o(null),d(null),w(""),C(""),k(!1)},className:"w-full px-2 py-1.5 rounded text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20",children:"Clear date filter"})})]})]}),a.slice(0,3).map(e=>{let t=S[e];return(0,s.jsxs)("button",{onClick:()=>T(e),className:(0,_.cn)("flex items-center gap-1 px-2 py-1 rounded-full text-xs","bg-blue-100 dark:bg-blue-900/30","text-blue-700 dark:text-blue-300","hover:bg-blue-200 dark:hover:bg-blue-900/50","transition-colors"),children:[(0,s.jsx)("span",{children:t.icon}),(0,s.jsx)("span",{children:t.shortLabel}),(0,s.jsx)(M.A,{className:"w-3 h-3"})]},e)}),a.length>3&&(0,s.jsxs)("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:["+",a.length-3," more"]}),(0,s.jsx)("div",{className:"flex-1"}),c>0&&(0,s.jsxs)("button",{onClick:x,className:"flex items-center gap-1 px-2 py-1 text-xs text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-300",children:[(0,s.jsx)(M.A,{className:"w-3 h-3"}),(0,s.jsxs)("span",{children:["Clear ",c," filter",c>1?"s":""]})]})]})]})}var V=a(80215),X=a(47665);let Z={notifications:{title:"Stay Connected",intro:"Stay connected with the cooking community! See who's interacting with your recipes and posts. Engaging with others helps you learn new techniques and share your cooking journey.",tips:["Follow cooks whose style inspires you","Share your cooking wins and learn from the community","Respond to comments to build connections"],icon:p.A,color:"blue"},alerts:{title:"Why Review Your Safety Alerts?",intro:"Safety alerts are your kitchen's guardian. These critical warnings help prevent accidents before they happen.",tips:["Each alert is a learning opportunity to identify risky habits","Faster response times mean better safety awareness","Reviewing past alerts helps you develop safer cooking practices","Track your improvement over time"],icon:o.A,color:"red"},notices:{title:"Learning from Hazard Notices",intro:"Hazard notices are gentle reminders to keep you on track. They help you maintain good practices without the urgency of safety alerts.",tips:["Notices reveal patterns in your cooking habits","Step-away alerts might indicate when you tend to multitask","Technique tips help improve your knife skills over time","Building habits turns good practices into automatic behavior"],icon:p.A,color:"yellow"},analytics:{title:"Your Kitchen Safety Story",intro:"Data tells a story. Your kitchen safety analytics reveal patterns you might not notice day-to-day.",tips:["Understand your cooking habits through visual trends","Identify peak risk times during your cooking sessions","Celebrate your safety improvements with concrete data","Use insights to set safety goals for yourself"],icon:V.A,color:"purple"}};function ee({type:e,avgResponseTime:t,className:a}){let[l,n]=(0,r.useState)(!0),[o,i]=(0,r.useState)(!1);if((0,r.useEffect)(()=>{let t=`safety-banner-dismissed-${e}`;"true"===localStorage.getItem(t)&&i(!0)},[e]),o)return(0,s.jsx)("button",{onClick:()=>{let t=`safety-banner-dismissed-${e}`;localStorage.removeItem(t),i(!1)},className:(0,_.cn)("text-xs text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-300","underline decoration-dotted",a),children:"Show tips"});let d=Z[e],c=d.icon,x={blue:{border:"border-blue-200 dark:border-blue-800",bg:"bg-blue-50 dark:bg-blue-950/30",icon:"text-blue-600 dark:text-blue-400",title:"text-blue-900 dark:text-blue-100"},red:{border:"border-red-200 dark:border-red-800",bg:"bg-red-50 dark:bg-red-950/30",icon:"text-red-600 dark:text-red-400",title:"text-red-900 dark:text-red-100"},yellow:{border:"border-yellow-200 dark:border-yellow-800",bg:"bg-yellow-50 dark:bg-yellow-950/30",icon:"text-yellow-600 dark:text-yellow-400",title:"text-yellow-900 dark:text-yellow-100"},purple:{border:"border-purple-200 dark:border-purple-800",bg:"bg-purple-50 dark:bg-purple-950/30",icon:"text-purple-600 dark:text-purple-400",title:"text-purple-900 dark:text-purple-100"}}[d.color];return(0,s.jsxs)("div",{className:(0,_.cn)("rounded-xl border overflow-hidden transition-all",x.border,x.bg,a),children:[(0,s.jsxs)("button",{onClick:()=>n(!l),className:"w-full flex items-center justify-between p-4 text-left",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(c,{className:(0,_.cn)("w-5 h-5",x.icon)}),(0,s.jsx)("span",{className:(0,_.cn)("font-semibold",x.title),children:d.title})]}),(0,s.jsx)("div",{className:"flex items-center gap-2",children:l?(0,s.jsx)(X.A,{className:"w-4 h-4 text-slate-500"}):(0,s.jsx)(Y.A,{className:"w-4 h-4 text-slate-500"})})]}),l&&(0,s.jsxs)("div",{className:"px-4 pb-4 pt-0",children:[(0,s.jsx)("p",{className:"text-sm text-slate-700 dark:text-slate-300 mb-3",children:d.intro}),(0,s.jsx)("ul",{className:"space-y-2 mb-4",children:d.tips.map((e,t)=>(0,s.jsxs)("li",{className:"flex items-start gap-2 text-sm text-slate-600 dark:text-slate-400",children:[(0,s.jsx)("span",{className:"text-slate-400 dark:text-slate-500 mt-0.5",children:"•"}),(0,s.jsx)("span",{children:e})]},t))}),"alerts"===e&&void 0!==t&&t>0&&(0,s.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-white/50 dark:bg-black/20 rounded-lg",children:[(0,s.jsx)(W.A,{className:"w-4 h-4 text-green-600 dark:text-green-400"}),(0,s.jsxs)("span",{className:"text-sm text-slate-700 dark:text-slate-300",children:["Your average response time: ",(0,s.jsxs)("strong",{children:[t," seconds"]}),t<15&&" — Great job!",t>=15&&t<30&&" — Good awareness!",t>=30&&" — Room for improvement"]})]}),(0,s.jsx)("div",{className:"flex justify-end mt-3",children:(0,s.jsxs)("button",{onClick:()=>{let t=`safety-banner-dismissed-${e}`;localStorage.setItem(t,"true"),i(!0)},className:"flex items-center gap-1 text-xs text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-300",children:[(0,s.jsx)(M.A,{className:"w-3 h-3"}),(0,s.jsx)("span",{children:"Hide tips"})]})})]})]})}function et({severityFilter:e,className:t}){let[a,l]=(0,r.useState)(!1),{events:n,loading:o,loadingMore:i,hasMore:d,total:c,error:x,loadMore:m,clearEvent:u,clearAllEvents:h,refresh:b,hazardTypeFilters:p,setHazardTypeFilters:g,searchQuery:f,setSearchQuery:k,dateRange:v,setDateRange:S,datePreset:C,setDatePreset:A,clearAllFilters:E,activeFilterCount:D}=function(e){let{severityFilter:t,limit:a=20,autoRefresh:s=!1,refreshInterval:l=6e4}=e,[n,o]=(0,r.useState)([]),[i,d]=(0,r.useState)(!0),[c,x]=(0,r.useState)(!1),[m,u]=(0,r.useState)(!1),[h,b]=(0,r.useState)(0),[p,g]=(0,r.useState)(null),[f,k]=(0,r.useState)(null),[v,j]=(0,r.useState)([]),[w,N]=(0,r.useState)(""),[_,S]=(0,r.useState)(null),[C,A]=(0,r.useState)(null),E=(0,r.useMemo)(()=>{let e=0;return v.length>0&&e++,w.trim()&&e++,(_||C)&&e++,e},[v,w,_,C]),D=(0,r.useCallback)(()=>{let e={severity_filter:t,limit:a};v.length>0&&(e.hazard_types=v),w.trim()&&(e.search=w.trim());let s=_;return C&&!_&&(s=function(e){let t=new Date,a=new Date(t);a.setHours(23,59,59,999);let s=new Date(t);switch(s.setHours(0,0,0,0),e){case"today":break;case"yesterday":s.setDate(s.getDate()-1),a.setDate(a.getDate()-1);break;case"7days":s.setDate(s.getDate()-6);break;case"month":s.setDate(1)}return{start:s,end:a}}(C)),s&&(e.start_date=s.start.toISOString(),e.end_date=s.end.toISOString()),e},[t,a,v,w,_,C]),L=(0,r.useCallback)(async e=>{try{let t=D();return e&&(t.cursor=e),await y.api.getSafetyEvents(t)}catch(e){throw e instanceof Error?e:Error("Failed to fetch events")}},[D]),T=(0,r.useCallback)(async()=>{d(!0),k(null);try{let e=await L();o(e.events),u(e.has_more),b(e.total),g(e.next_cursor)}catch(e){k(e instanceof Error?e:Error("Unknown error")),o([])}finally{d(!1)}},[L]),z=(0,r.useCallback)(async()=>{if(!c&&m&&p){x(!0),k(null);try{let e=await L(p);o(t=>[...t,...e.events]),u(e.has_more),g(e.next_cursor)}catch(e){k(e instanceof Error?e:Error("Unknown error"))}finally{x(!1)}}},[L,c,m,p]),F=(0,r.useCallback)(async e=>{try{await y.api.clearSafetyEvent(e),o(t=>t.filter(t=>t.id!==e)),b(e=>Math.max(0,e-1))}catch(e){throw k(e instanceof Error?e:Error("Failed to clear event")),e}},[]),R=(0,r.useCallback)(async()=>{try{await y.api.clearSafetyEvents(t),o([]),b(0),u(!1),g(null)}catch(e){throw k(e instanceof Error?e:Error("Failed to clear events")),e}},[t]),$=(0,r.useCallback)(()=>{j([]),N(""),S(null),A(null)},[]),M=(0,r.useCallback)(e=>{A(e),e&&S(null)},[]),W=(0,r.useCallback)(e=>{S(e),e&&A(null)},[]);return(0,r.useEffect)(()=>{T()},[t,v,w,_,C]),(0,r.useEffect)(()=>{if(!s)return;let e=setInterval(()=>{T()},l);return()=>clearInterval(e)},[s,l,T]),{events:n,loading:i,loadingMore:c,hasMore:m,total:h,nextCursor:p,error:f,loadMore:z,clearEvent:F,clearAllEvents:R,refresh:T,hazardTypeFilters:v,setHazardTypeFilters:j,searchQuery:w,setSearchQuery:N,dateRange:_,setDateRange:W,datePreset:C,setDatePreset:M,clearAllFilters:$,activeFilterCount:E}}({severityFilter:e,limit:20,autoRefresh:!1}),L=(0,r.useCallback)(async e=>{try{await u(e)}catch(e){console.error("Failed to clear event:",e)}},[u]),T=(0,r.useCallback)(async()=>{try{await h(),l(!1)}catch(e){console.error("Failed to clear all events:",e)}},[h]),z=n.length>0?n.filter(e=>e.acknowledged&&e.acknowledged_at).reduce((e,t)=>{let a=new Date(t.created_at).getTime();return e+(new Date(t.acknowledged_at).getTime()-a)/1e3},0)/Math.max(1,n.filter(e=>e.acknowledged&&e.acknowledged_at).length):0;return(0,s.jsxs)("div",{className:(0,_.cn)("space-y-4",t),children:[(0,s.jsx)(ee,{type:"alerts"===e?"alerts":"notices",avgResponseTime:"alerts"===e?Math.round(z):void 0}),(0,s.jsx)(J,{searchQuery:f,onSearchChange:k,hazardTypeFilters:p,onHazardTypeFiltersChange:g,datePreset:C,onDatePresetChange:A,dateRange:v,onDateRangeChange:S,activeFilterCount:D,onClearAllFilters:E,onRefresh:b,isLoading:o}),n.length>0&&(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:["Showing ",n.length," of ",c," events"]}),(0,s.jsx)("div",{className:"relative",children:a?(0,s.jsxs)("div",{className:"flex items-center gap-2 p-2 bg-red-50 dark:bg-red-900/20 rounded-lg border border-red-200 dark:border-red-800",children:[(0,s.jsx)("span",{className:"text-sm text-red-700 dark:text-red-300",children:"Clear all?"}),(0,s.jsx)("button",{onClick:T,className:"px-2 py-1 text-xs font-medium text-white bg-red-500 hover:bg-red-600 rounded",children:"Yes"}),(0,s.jsx)("button",{onClick:()=>l(!1),className:"px-2 py-1 text-xs font-medium text-red-700 dark:text-red-300 hover:bg-red-100 dark:hover:bg-red-900/30 rounded",children:"No"})]}):(0,s.jsxs)("button",{onClick:()=>l(!0),className:"flex items-center gap-1 px-3 py-1.5 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",children:[(0,s.jsx)(j.A,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"Clear all"})]})})]}),x&&(0,s.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:[(0,s.jsx)(w.A,{className:"w-5 h-5 text-red-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-red-700 dark:text-red-300",children:"Failed to load events"}),(0,s.jsx)("p",{className:"text-sm text-red-600 dark:text-red-400",children:x.message})]}),(0,s.jsx)("button",{onClick:b,className:"ml-auto px-3 py-1.5 text-sm font-medium text-red-700 dark:text-red-300 hover:bg-red-100 dark:hover:bg-red-900/30 rounded-lg",children:"Retry"})]}),o&&(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,s.jsx)(N.A,{className:"w-8 h-8 text-slate-400 animate-spin mb-3"}),(0,s.jsx)("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Loading events..."})]}),!o&&!x&&0===n.length&&(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,s.jsx)("div",{className:"w-16 h-16 rounded-full bg-slate-100 dark:bg-slate-800 flex items-center justify-center mb-4",children:(0,s.jsx)(w.A,{className:"w-8 h-8 text-slate-400"})}),D>0?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h3",{className:"font-medium text-slate-900 dark:text-white mb-1",children:"No matching events"}),(0,s.jsx)("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-4",children:"Try adjusting your filters to find more events"}),(0,s.jsx)("button",{onClick:E,className:"px-4 py-2 text-sm font-medium text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg",children:"Clear all filters"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("h3",{className:"font-medium text-slate-900 dark:text-white mb-1",children:["No ","alerts"===e?"safety alerts":"hazard notices"," yet"]}),(0,s.jsx)("p",{className:"text-sm text-slate-500 dark:text-slate-400 max-w-sm",children:"alerts"===e?"Safety alerts will appear here when critical situations are detected during cooking sessions.":"Hazard notices will appear here with helpful reminders and technique tips during cooking."})]})]}),!o&&n.length>0&&(0,s.jsx)("div",{className:"space-y-3",children:n.map(e=>(0,s.jsx)(q,{event:e,onClear:L,highlightText:f},e.id))}),!o&&d&&(0,s.jsxs)("div",{className:"flex flex-col items-center py-4",children:[(0,s.jsx)("button",{onClick:m,disabled:i,className:(0,_.cn)("px-6 py-2.5 text-sm font-medium rounded-lg transition-colors","bg-slate-100 dark:bg-slate-800","text-slate-700 dark:text-slate-300","hover:bg-slate-200 dark:hover:bg-slate-700","disabled:opacity-50 disabled:cursor-not-allowed"),children:i?(0,s.jsxs)("span",{className:"flex items-center gap-2",children:[(0,s.jsx)(N.A,{className:"w-4 h-4 animate-spin"}),"Loading..."]}):"Load more events"}),(0,s.jsxs)("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-2",children:["Showing ",n.length," of ",c," events"]})]})]})}var ea=a(7154),es=a(78663),er=a(73388),el=a(53190),en=a(14293),eo=a(42410),ei=a(57274),ed=a(40811),ec=a(98743);function ex({data:e,className:t}){let a=(0,r.useMemo)(()=>e.map(e=>({date:new Date(e.date).toLocaleDateString("en-US",{month:"short",day:"numeric"}),"Safety Alerts":e.alerts_count,"Hazard Notices":e.notices_count})),[e]);return 0===e.length?(0,s.jsx)("div",{className:t,children:(0,s.jsx)("div",{className:"flex items-center justify-center h-64 text-slate-500 dark:text-slate-400",children:"No data available for the selected period"})}):(0,s.jsx)("div",{className:t,children:(0,s.jsx)(es.u,{width:"100%",height:300,children:(0,s.jsxs)(er.b,{data:a,margin:{top:5,right:30,left:20,bottom:5},children:[(0,s.jsx)(el.d,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),(0,s.jsx)(en.W,{dataKey:"date",tick:{fontSize:12,fill:"#64748b"},tickLine:{stroke:"#cbd5e1"}}),(0,s.jsx)(eo.h,{tick:{fontSize:12,fill:"#64748b"},tickLine:{stroke:"#cbd5e1"},allowDecimals:!1}),(0,s.jsx)(ei.m,{contentStyle:{backgroundColor:"white",border:"1px solid #e2e8f0",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"},labelStyle:{fontWeight:600,marginBottom:4}}),(0,s.jsx)(ed.s,{wrapperStyle:{paddingTop:20},iconType:"circle"}),(0,s.jsx)(ec.N1,{type:"monotone",dataKey:"Safety Alerts",stroke:"#ef4444",strokeWidth:2,dot:{fill:"#ef4444",strokeWidth:2,r:4},activeDot:{r:6}}),(0,s.jsx)(ec.N1,{type:"monotone",dataKey:"Hazard Notices",stroke:"#f59e0b",strokeWidth:2,dot:{fill:"#f59e0b",strokeWidth:2,r:4},activeDot:{r:6}})]})})})}var em=a(39733),eu=a(54764),eh=a(82759);function eb({data:e,className:t}){let a=(0,r.useMemo)(()=>e.map(e=>({name:S[e.type]?.shortLabel||e.type,fullName:S[e.type]?.label||e.type,count:e.count,color:C[e.severity]?.color||"#6366f1",icon:S[e.type]?.icon||""})).sort((e,t)=>t.count-e.count).slice(0,8),[e]);return 0===e.length?(0,s.jsx)("div",{className:t,children:(0,s.jsx)("div",{className:"flex items-center justify-center h-64 text-slate-500 dark:text-slate-400",children:"No data available for the selected period"})}):(0,s.jsx)("div",{className:t,children:(0,s.jsx)(es.u,{width:"100%",height:300,children:(0,s.jsxs)(em.E,{data:a,layout:"vertical",margin:{top:5,right:30,left:60,bottom:5},children:[(0,s.jsx)(el.d,{strokeDasharray:"3 3",stroke:"#e2e8f0",horizontal:!1}),(0,s.jsx)(en.W,{type:"number",tick:{fontSize:12,fill:"#64748b"},tickLine:{stroke:"#cbd5e1"},allowDecimals:!1}),(0,s.jsx)(eo.h,{type:"category",dataKey:"name",tick:{fontSize:12,fill:"#64748b"},tickLine:{stroke:"#cbd5e1"},width:55}),(0,s.jsx)(ei.m,{contentStyle:{backgroundColor:"white",border:"1px solid #e2e8f0",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"},formatter:(e,t,a)=>{let s=a?.payload;return[`${e??0} events`,`${s?.icon||""} ${s?.fullName||""}`]}}),(0,s.jsx)(eu.yP,{dataKey:"count",radius:[0,4,4,0],children:a.map((e,t)=>(0,s.jsx)(eh.f,{fill:e.color},`cell-${t}`))})]})})})}var ep=a(12613),eg=a(69437);let ef=Math.PI/180;function ek(e){let{cx:t,cy:a,midAngle:r,innerRadius:l,outerRadius:n,percent:o}=e;if("number"!=typeof t||"number"!=typeof a||"number"!=typeof r||"number"!=typeof l||"number"!=typeof n||"number"!=typeof o||o<.05)return null;let i=l+(n-l)*.5,d=t+i*Math.cos(-r*ef),c=a+i*Math.sin(-r*ef);return(0,s.jsx)("text",{x:d,y:c,fill:"white",textAnchor:"middle",dominantBaseline:"central",fontSize:12,fontWeight:600,children:`${(100*o).toFixed(0)}%`})}function ey({data:e,className:t}){let a=(0,r.useMemo)(()=>e.filter(e=>e.count>0).map(e=>({name:C[e.severity]?.label||e.severity,value:e.count,color:C[e.severity]?.color||"#6366f1",percentage:e.percentage})),[e]);return 0===a.length?(0,s.jsx)("div",{className:t,children:(0,s.jsx)("div",{className:"flex items-center justify-center h-64 text-slate-500 dark:text-slate-400",children:"No data available for the selected period"})}):(0,s.jsx)("div",{className:t,children:(0,s.jsx)(es.u,{width:"100%",height:300,children:(0,s.jsxs)(ep.r,{children:[(0,s.jsx)(eg.Fq,{data:a,cx:"50%",cy:"50%",labelLine:!1,label:ek,outerRadius:100,innerRadius:50,fill:"#8884d8",dataKey:"value",paddingAngle:2,children:a.map((e,t)=>(0,s.jsx)(eh.f,{fill:e.color,stroke:"white",strokeWidth:2},`cell-${t}`))}),(0,s.jsx)(ei.m,{contentStyle:{backgroundColor:"white",border:"1px solid #e2e8f0",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"},formatter:(e,t,a)=>{let s=a?.payload,r=s?.percentage??0;return[`${e??0} events (${r.toFixed(1)}%)`,"Count"]}}),(0,s.jsx)(ed.s,{layout:"horizontal",verticalAlign:"bottom",align:"center",iconType:"circle",wrapperStyle:{paddingTop:20}})]})})})}var ev=a(63121),ej=a(81307),ew=a(720);function eN({data:e,targetSeconds:t=15,className:a}){let l=(0,r.useMemo)(()=>e.map(e=>({date:new Date(e.date).toLocaleDateString("en-US",{month:"short",day:"numeric"}),seconds:Math.round(e.avg_seconds),formatted:A(e.avg_seconds)})),[e]),n=(0,r.useMemo)(()=>0===e.length?0:e.reduce((e,t)=>e+t.avg_seconds,0)/e.length,[e]);return 0===e.length?(0,s.jsx)("div",{className:a,children:(0,s.jsx)("div",{className:"flex items-center justify-center h-64 text-slate-500 dark:text-slate-400",children:"No response time data available for the selected period"})}):(0,s.jsxs)("div",{className:a,children:[(0,s.jsx)("div",{className:"mb-4 text-center",children:(0,s.jsxs)("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:["Average response time:"," ",(0,s.jsx)("span",{className:"font-semibold text-slate-900 dark:text-white",children:A(n)}),n<=t&&(0,s.jsx)("span",{className:"ml-2 text-green-600 dark:text-green-400",children:"Under target"}),n>t&&(0,s.jsxs)("span",{className:"ml-2 text-amber-600 dark:text-amber-400",children:["Above target (",t,"s)"]})]})}),(0,s.jsx)(es.u,{width:"100%",height:250,children:(0,s.jsxs)(ev.Q,{data:l,margin:{top:10,right:30,left:20,bottom:5},children:[(0,s.jsx)("defs",{children:(0,s.jsxs)("linearGradient",{id:"responseTimeGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,s.jsx)("stop",{offset:"5%",stopColor:"#3b82f6",stopOpacity:.3}),(0,s.jsx)("stop",{offset:"95%",stopColor:"#3b82f6",stopOpacity:0})]})}),(0,s.jsx)(el.d,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),(0,s.jsx)(en.W,{dataKey:"date",tick:{fontSize:12,fill:"#64748b"},tickLine:{stroke:"#cbd5e1"}}),(0,s.jsx)(eo.h,{tick:{fontSize:12,fill:"#64748b"},tickLine:{stroke:"#cbd5e1"},tickFormatter:e=>`${e}s`}),(0,s.jsx)(ei.m,{contentStyle:{backgroundColor:"white",border:"1px solid #e2e8f0",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"},formatter:e=>[A(Number(e)||0),"Response Time"],labelStyle:{fontWeight:600,marginBottom:4}}),(0,s.jsx)(ej.e_,{y:t,stroke:"#10b981",strokeDasharray:"5 5",strokeWidth:2,label:{value:`Target: ${t}s`,position:"insideTopRight",fill:"#10b981",fontSize:11}}),(0,s.jsx)(ew.Gk,{type:"monotone",dataKey:"seconds",stroke:"#3b82f6",strokeWidth:2,fill:"url(#responseTimeGradient)",dot:{fill:"#3b82f6",strokeWidth:2,r:4},activeDot:{r:6,stroke:"#3b82f6",strokeWidth:2,fill:"white"}})]})})]})}let e_=["today","yesterday","7days","14days","30days"];function eS({className:e}){let{data:t,loading:a,error:l,period:n,setPeriod:o,refresh:i}=function(e={}){let{period:t="7days",autoRefresh:a=!1,refreshInterval:s=6e4}=e,[l,n]=(0,r.useState)(null),[o,i]=(0,r.useState)(!0),[d,c]=(0,r.useState)(null),[x,m]=(0,r.useState)(t),u=(0,r.useCallback)(async()=>{i(!0),c(null);try{let e=await y.api.getSafetyAnalytics(x);n(e)}catch(e){c(e instanceof Error?e:Error("Failed to fetch analytics")),n(v)}finally{i(!1)}},[x]),h=(0,r.useCallback)(async()=>{await u()},[u]);return(0,r.useEffect)(()=>{u()},[u]),(0,r.useEffect)(()=>{if(!a)return;let e=setInterval(()=>{u()},s);return()=>clearInterval(e)},[a,s,u]),{data:l,loading:o,error:d,period:x,setPeriod:m,refresh:h}}({period:"7days"});return(0,s.jsxs)("div",{className:(0,_.cn)("space-y-6",e),children:[(0,s.jsx)(ee,{type:"analytics"}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,s.jsx)("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Time Period:"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-1",children:e_.map(e=>(0,s.jsx)("button",{onClick:()=>o(e),className:(0,_.cn)("px-3 py-1.5 text-sm rounded-lg transition-colors",n===e?"bg-blue-500 text-white":"bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 hover:bg-slate-200 dark:hover:bg-slate-700"),children:E(e)},e))})]}),l&&(0,s.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:[(0,s.jsx)(w.A,{className:"w-5 h-5 text-red-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-red-700 dark:text-red-300",children:"Failed to load analytics"}),(0,s.jsx)("p",{className:"text-sm text-red-600 dark:text-red-400",children:l.message})]}),(0,s.jsx)("button",{onClick:i,className:"ml-auto px-3 py-1.5 text-sm font-medium text-red-700 dark:text-red-300 hover:bg-red-100 dark:hover:bg-red-900/30 rounded-lg",children:"Retry"})]}),a&&(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,s.jsx)(N.A,{className:"w-8 h-8 text-slate-400 animate-spin mb-3"}),(0,s.jsx)("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Loading analytics..."})]}),!a&&!l&&t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{className:"p-4 bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-700",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-slate-500 dark:text-slate-400 mb-1",children:[(0,s.jsx)(ea.A,{className:"w-4 h-4"}),(0,s.jsx)("span",{className:"text-xs font-medium uppercase tracking-wide",children:"Total Events"})]}),(0,s.jsx)("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:t.summary.total_events}),(0,s.jsx)("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:E(n)})]}),(0,s.jsxs)("div",{className:"p-4 bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-700",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-slate-500 dark:text-slate-400 mb-1",children:[(0,s.jsx)(W.A,{className:"w-4 h-4"}),(0,s.jsx)("span",{className:"text-xs font-medium uppercase tracking-wide",children:"Avg Response"})]}),(0,s.jsx)("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:t.summary.avg_response_seconds>0?A(t.summary.avg_response_seconds):"—"}),(0,s.jsx)("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:t.summary.avg_response_seconds>0&&t.summary.avg_response_seconds<=15?"Great job!":t.summary.avg_response_seconds>15?"Room to improve":"No data"})]}),(0,s.jsxs)("div",{className:"p-4 bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-700",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-slate-500 dark:text-slate-400 mb-1",children:[(0,s.jsx)(D.A,{className:"w-4 h-4"}),(0,s.jsx)("span",{className:"text-xs font-medium uppercase tracking-wide",children:"Most Common"})]}),t.summary.most_common_type?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("p",{className:"text-lg font-bold text-slate-900 dark:text-white flex items-center gap-2",children:[(0,s.jsx)("span",{children:S[t.summary.most_common_type]?.icon}),(0,s.jsx)("span",{className:"truncate",children:S[t.summary.most_common_type]?.shortLabel||t.summary.most_common_type})]}),(0,s.jsx)("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:S[t.summary.most_common_type]?.label})]}):(0,s.jsx)("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"—"})]}),(0,s.jsxs)("div",{className:"p-4 bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-700",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-slate-500 dark:text-slate-400 mb-1",children:[(0,s.jsx)(V.A,{className:"w-4 h-4"}),(0,s.jsx)("span",{className:"text-xs font-medium uppercase tracking-wide",children:"Improvement"})]}),(0,s.jsxs)("p",{className:(0,_.cn)("text-2xl font-bold",t.summary.improvement_percentage>0?"text-green-600 dark:text-green-400":t.summary.improvement_percentage<0?"text-red-600 dark:text-red-400":"text-slate-900 dark:text-white"),children:[t.summary.improvement_percentage>0?"+":"",t.summary.improvement_percentage.toFixed(0),"%"]}),(0,s.jsx)("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:"vs previous period"})]})]}),(0,s.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"p-4 bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-700",children:[(0,s.jsx)("h3",{className:"font-semibold text-slate-900 dark:text-white mb-4",children:"Events Over Time"}),(0,s.jsx)(ex,{data:t.events_by_date})]}),(0,s.jsxs)("div",{className:"p-4 bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-700",children:[(0,s.jsx)("h3",{className:"font-semibold text-slate-900 dark:text-white mb-4",children:"Events by Type"}),(0,s.jsx)(eb,{data:t.events_by_type})]}),(0,s.jsxs)("div",{className:"p-4 bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-700",children:[(0,s.jsx)("h3",{className:"font-semibold text-slate-900 dark:text-white mb-4",children:"Severity Distribution"}),(0,s.jsx)(ey,{data:t.severity_distribution})]}),(0,s.jsxs)("div",{className:"p-4 bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-700",children:[(0,s.jsx)("h3",{className:"font-semibold text-slate-900 dark:text-white mb-4",children:"Response Time Trend"}),(0,s.jsx)(eN,{data:t.response_times,targetSeconds:15})]})]}),0===t.summary.total_events&&(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)("div",{className:"w-16 h-16 rounded-full bg-slate-100 dark:bg-slate-800 flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)(ea.A,{className:"w-8 h-8 text-slate-400"})}),(0,s.jsx)("h3",{className:"font-medium text-slate-900 dark:text-white mb-1",children:"No events yet"}),(0,s.jsx)("p",{className:"text-sm text-slate-500 dark:text-slate-400 max-w-sm mx-auto",children:"Safety events will appear here as you use the cooking assistant. Start a cooking session to begin tracking your kitchen safety."})]})]})]})}let eC={moderation_approved:o.A,moderation_rejected:o.A,new_follower:i.A,post_liked:d.A,new_comment:c.A},eA={moderation_approved:"bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400",moderation_rejected:"bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400",new_follower:"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400",post_liked:"bg-pink-100 dark:bg-pink-900/30 text-pink-600 dark:text-pink-400",new_comment:"bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400"},eE={moderation_approved:"Approved",moderation_rejected:"Rejected",new_follower:"New Follower",post_liked:"Like",new_comment:"Comment"};function eD({notification:e,onMarkAsRead:t}){let a,r,l,o,i=eC[e.type]||x.A,d=eA[e.type]||"bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400",c=eE[e.type]||"Notification";return(0,s.jsx)(n(),{href:(()=>{let t=e.data;switch(e.type){case"post_liked":case"new_comment":case"moderation_approved":case"moderation_rejected":return t?.post_id?`/community/post/${t.post_id}`:"/community";case"new_follower":return t?.follower_id?`/community/user/${t.follower_id}`:"/community";default:return"#"}})(),className:(0,_.cn)("block bg-white dark:bg-slate-900 rounded-xl border transition-all","hover:shadow-md hover:border-slate-300 dark:hover:border-slate-600",e.is_read?"border-slate-200 dark:border-slate-800":"border-orange-200 dark:border-orange-900/50 bg-orange-50/30 dark:bg-orange-950/10"),children:(0,s.jsx)("div",{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-start gap-4",children:[(0,s.jsx)("div",{className:(0,_.cn)("p-3 rounded-xl shrink-0",d),children:(0,s.jsx)(i,{className:"w-5 h-5"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,s.jsx)("span",{className:(0,_.cn)("text-xs font-medium px-2 py-0.5 rounded-full",d),children:c}),(0,s.jsx)("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:(a=new Date(e.created_at),o=Math.floor((l=Math.floor((r=Math.floor((new Date().getTime()-a.getTime())/6e4))/60))/24),r<1?"Just now":r<60?`${r}m ago`:l<24?`${l}h ago`:o<7?`${o}d ago`:a.toLocaleDateString())}),!e.is_read&&(0,s.jsx)("span",{className:"w-2 h-2 bg-orange-500 rounded-full"})]}),(0,s.jsx)("h3",{className:(0,_.cn)("font-medium mb-1",e.is_read?"text-slate-700 dark:text-slate-300":"text-slate-900 dark:text-white"),children:e.title}),(0,s.jsx)("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:e.message})]}),!e.is_read&&(0,s.jsx)("button",{onClick:a=>{a.preventDefault(),a.stopPropagation(),t(e.id)},className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-colors shrink-0",title:"Mark as read",children:(0,s.jsx)(m.A,{className:"w-4 h-4 text-slate-500"})})]})})})}function eL(){let[e,t]=(0,r.useState)("all"),{notifications:a,unreadCount:l,loading:n,hasMore:o,loadMore:i,markAsRead:d,markAllAsRead:c}=(0,k.E)({limit:20,autoRefresh:!1}),m=a.filter(t=>"all"===e||("unread"===e?!t.is_read:t.type===e));return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(ee,{type:"notifications"}),l>0&&(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsxs)(f.$,{variant:"outline",size:"sm",onClick:c,className:"gap-2",children:[(0,s.jsx)(u.A,{className:"w-4 h-4"}),"Mark all read"]})}),(0,s.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,s.jsx)(h.A,{className:"w-4 h-4 text-slate-500"}),[{value:"all",label:"All"},{value:"unread",label:"Unread"},{value:"new_follower",label:"Followers"},{value:"post_liked",label:"Likes"},{value:"new_comment",label:"Comments"},{value:"moderation_approved",label:"Moderation"}].map(a=>(0,s.jsxs)("button",{onClick:()=>t(a.value),className:(0,_.cn)("px-3 py-1.5 text-sm font-medium rounded-lg transition-colors",e===a.value?"bg-orange-100 dark:bg-orange-900/30 text-orange-600 dark:text-orange-400":"bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 hover:bg-slate-200 dark:hover:bg-slate-700"),children:[a.label,"unread"===a.value&&l>0&&(0,s.jsx)("span",{className:"ml-1.5 bg-orange-500 text-white text-xs px-1.5 py-0.5 rounded-full",children:l})]},a.value))]}),n&&0===a.length?(0,s.jsxs)("div",{className:"text-center py-16",children:[(0,s.jsx)("div",{className:"animate-spin w-8 h-8 border-3 border-orange-500 border-t-transparent rounded-full mx-auto"}),(0,s.jsx)("p",{className:"text-slate-500 dark:text-slate-400 mt-4",children:"Loading notifications..."})]}):0===m.length?(0,s.jsxs)("div",{className:"text-center py-16 bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800",children:[(0,s.jsx)(x.A,{className:"w-12 h-12 text-slate-300 dark:text-slate-600 mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium text-slate-900 dark:text-white mb-2",children:"unread"===e?"No unread notifications":"No notifications yet"}),(0,s.jsx)("p",{className:"text-slate-500 dark:text-slate-400",children:"unread"===e?"You're all caught up!":"When you get notifications, they'll appear here."})]}):(0,s.jsxs)("div",{className:"space-y-3",children:[m.map(e=>(0,s.jsx)(eD,{notification:e,onMarkAsRead:d},e.id)),o&&(0,s.jsx)("div",{className:"text-center pt-4",children:(0,s.jsx)(f.$,{variant:"outline",onClick:i,disabled:n,children:n?"Loading...":"Load more"})})]})]})}let eT=[{id:"notifications",label:"Notifications",icon:x.A,color:"blue"},{id:"alerts",label:"Safety Alerts",icon:b.A,color:"red"},{id:"notices",label:"Hazard Notices",icon:p.A,color:"yellow"},{id:"analytics",label:"Event Analytics",icon:g.A,color:"purple"}];function ez(){let[e,t]=(0,r.useState)("notifications"),{unreadCount:a}=(0,k.E)({limit:1}),{alertsCount:l,noticesCount:n}=function(){let[e,t]=(0,r.useState)(0),[a,s]=(0,r.useState)(0),[l,n]=(0,r.useState)(!0),o=(0,r.useCallback)(async()=>{try{let[e,a]=await Promise.all([y.api.getSafetyEvents({severity_filter:"alerts",limit:1}),y.api.getSafetyEvents({severity_filter:"notices",limit:1})]);t(e.total),s(a.total)}catch(e){console.error("Failed to fetch event counts:",e)}finally{n(!1)}},[]);return(0,r.useEffect)(()=>{o()},[o]),{alertsCount:e,noticesCount:a,totalCount:e+a,loading:l,refresh:o}}();return(0,r.useEffect)(()=>{let e=localStorage.getItem("notifications-active-tab");e&&eT.some(t=>t.id===e)&&t(e)},[]),(0,s.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"Notifications"}),(0,s.jsx)("p",{className:"text-slate-600 dark:text-slate-400 mt-1",children:"Stay updated with your activity and kitchen safety events"})]}),(0,s.jsx)("div",{className:"border-b border-slate-200 dark:border-slate-700 mb-6",children:(0,s.jsx)("nav",{className:"flex gap-1 -mb-px overflow-x-auto","aria-label":"Tabs",children:eT.map(r=>{let o=e===r.id,i=(e=>{switch(e){case"notifications":return a>0?a:void 0;case"alerts":return l>0?l:void 0;case"notices":return n>0?n:void 0;default:return}})(r.id),d=r.icon;return(0,s.jsxs)("button",{onClick:()=>{var e;t(e=r.id),localStorage.setItem("notifications-active-tab",e)},className:(0,_.cn)("flex items-center gap-2 px-4 py-3 text-sm font-medium border-b-2 transition-colors whitespace-nowrap",((e,t)=>{if(!t)return"border-transparent text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-300";switch(e.color){case"blue":return"border-blue-500 text-blue-600 dark:text-blue-400";case"red":return"border-red-500 text-red-600 dark:text-red-400";case"yellow":return"border-yellow-500 text-yellow-600 dark:text-yellow-400";case"purple":return"border-purple-500 text-purple-600 dark:text-purple-400";default:return"border-slate-500 text-slate-600 dark:text-slate-400"}})(r,o)),"aria-current":o?"page":void 0,children:[(0,s.jsx)(d,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:r.label}),void 0!==i&&(0,s.jsx)("span",{className:(0,_.cn)("text-xs text-white px-1.5 py-0.5 rounded-full min-w-[20px] text-center",(e=>{switch(e.color){case"blue":return"bg-blue-500";case"red":return"bg-red-500";case"yellow":return"bg-yellow-500";case"purple":return"bg-purple-500";default:return"bg-slate-500"}})(r)),children:i>99?"99+":i})]},r.id)})})}),(0,s.jsxs)("div",{children:["notifications"===e&&(0,s.jsx)(eL,{}),"alerts"===e&&(0,s.jsx)(et,{severityFilter:"alerts"}),"notices"===e&&(0,s.jsx)(et,{severityFilter:"notices"}),"analytics"===e&&(0,s.jsx)(eS,{})]})]})}},31616:(e,t,a)=>{"use strict";a.d(t,{cn:()=>l});var s=a(43696),r=a(33086);function l(...e){return(0,r.QP)((0,s.$)(e))}},33971:(e,t,a)=>{"use strict";a.d(t,{$:()=>i,r:()=>o});var s=a(55155),r=a(3456),l=a(47426),n=a(31616);let o=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-xl text-sm font-bold transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:ring-2 focus-visible:ring-orange-500 focus-visible:ring-offset-2",{variants:{variant:{default:"bg-orange-500 text-white hover:bg-orange-600 shadow-md shadow-orange-200 dark:shadow-orange-900/20",destructive:"bg-red-500 text-white hover:bg-red-600 shadow-md shadow-red-200 dark:shadow-red-900/20",outline:"border-2 border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 text-slate-900 dark:text-white hover:bg-slate-50 dark:hover:bg-slate-800 hover:border-slate-300 dark:hover:border-slate-600",secondary:"bg-slate-100 dark:bg-slate-800 text-slate-900 dark:text-white hover:bg-slate-200 dark:hover:bg-slate-700",ghost:"hover:bg-slate-100 dark:hover:bg-slate-800 text-slate-900 dark:text-white",link:"text-orange-500 dark:text-orange-400 underline-offset-4 hover:underline"},size:{default:"h-11 px-5 py-2",sm:"h-9 rounded-lg px-3 text-xs",lg:"h-14 rounded-2xl px-8 text-base",icon:"size-10"}},defaultVariants:{variant:"default",size:"default"}});function i({className:e,variant:t,size:a,asChild:l=!1,...i}){let d=l?r.DX:"button";return(0,s.jsx)(d,{"data-slot":"button",className:(0,n.cn)(o({variant:t,size:a,className:e})),...i})}},47963:(e,t,a)=>{"use strict";a.d(t,{E:()=>l});var s=a(21555),r=a(15885);function l(e={}){let{autoRefresh:t=!0,refreshInterval:a=3e4,limit:n=10}=e,[o,i]=(0,s.useState)([]),[d,c]=(0,s.useState)(0),[x,m]=(0,s.useState)(!0),[u,h]=(0,s.useState)(null),[b,p]=(0,s.useState)(!1),[g,f]=(0,s.useState)(1),k=(0,s.useCallback)(async(e=1,t=!1)=>{try{t||m(!0),h(null);let a=await r.api.getNotifications({page:e,limit:n});t?i(e=>[...e,...a.notifications]):i(a.notifications),c(a.unread_count),p(a.has_more),f(a.page)}catch(e){h(e instanceof Error?e:Error("Failed to fetch notifications"))}finally{m(!1)}},[n]),y=(0,s.useCallback)(async()=>{await k(1,!1)},[k]),v=(0,s.useCallback)(async()=>{b&&!x&&await k(g+1,!0)},[k,b,x,g]),j=(0,s.useCallback)(async e=>{try{let t=await r.api.markNotificationRead(e);c(t.unread_count),i(t=>t.map(t=>t.id===e?{...t,is_read:!0}:t))}catch(e){console.error("Failed to mark notification as read:",e)}},[]),w=(0,s.useCallback)(async()=>{try{let e=await r.api.markNotificationRead(void 0,!0);c(e.unread_count),i(e=>e.map(e=>({...e,is_read:!0})))}catch(e){console.error("Failed to mark all notifications as read:",e)}},[]);return(0,s.useEffect)(()=>{k()},[k]),(0,s.useEffect)(()=>{if(!t)return;let e=setInterval(()=>{k(1,!1)},a);return()=>clearInterval(e)},[t,a,k]),{notifications:o,unreadCount:d,loading:x,error:u,hasMore:b,page:g,refresh:y,loadMore:v,markAsRead:j,markAllAsRead:w}}}},e=>{e.O(0,[9731,9631,7139,3948,3970,8866,5885,6939,1170,7358],()=>e(e.s=28975)),_N_E=e.O()}]);